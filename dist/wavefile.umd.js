/*!
https://github.com/rochars/wavefile
Copyright (c) 2017 Brett Zamir, 2012 Niklas von Hertzen.
Copyright (c) 2016 acida, 2018 Rafael da Silva Rocha.
Copyright (c) 2017-2018 Rafael da Silva Rocha.

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
var window=window||{};var g,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},k;if("function"==typeof Object.setPrototypeOf)k=Object.setPrototypeOf;else{var n;a:{var ba={A:!0},ca={};try{ca.__proto__=ba;n=ca.A;break a}catch(a){}n=!1}k=n?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}
var da=k,ea="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},fa="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ha(a,b){if(b){var c=fa;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ea(c,a,{configurable:!0,writable:!0,value:b})}}
ha("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}});ha("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;c=c||0;for(0>c&&(c=Math.max(c+e,0));c<e;c++){var f=b[c];if(f===a||Object.is(f,a))return!0}return!1}});
ha("String.prototype.codePointAt",function(a){return a?a:function(a){if(null==this)throw new TypeError("The 'this' value for String.prototype.codePointAt must not be null or undefined");var b=this.length;a=Number(a)||0;if(0<=a&&a<b){a|=0;var d=this.charCodeAt(a);if(55296>d||56319<d||a+1===b)return d;a=this.charCodeAt(a+1);return 56320>a||57343<a?d:1024*(d-55296)+a+9216}}});var exports=r||{};window.WaveFile=r;"use strict";var ia=new Float32Array(1);
function ja(a,b){return a=0<a?parseInt(a/b.u*b.o,10):parseInt(a/b.v*b.s,10)}function ka(a,b){return parseInt(0<a?a*b.o:a*b.s,10)}function la(a,b){return 0<a?a/b.u:a/b.v}function ma(a){ia[0]=a;return ia[0]}function na(a,b){function c(a){return a}a!=b&&(["32f","64"].includes(a)?["32f","64"].includes(b)?c=ma:c=ka:c=["32f","64"].includes(b)?la:ja);return c}function oa(a){if("32f"!=a&&"64"!=a&&("8">parseInt(a,10)||"53"<parseInt(a,10)))throw Error("Invalid bit depth.");}
var pa=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],qa=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767],v=0,y=0,z=0,B=0,C=7;
function ra(a){for(var b=new Uint8Array(a.length/2+512),c=[],d=0,e=0;e<a.length;e++)0==e%505&&0!=e&&(b.set(sa(c),d),d+=256,c=[]),c.push(a[e]);return b}function ta(a,b){b=void 0===b?256:b;for(var c=new Int16Array(2*a.length),d=[],e=0,f=0;f<a.length;f++)0==f%b&&0!=f&&(c.set(ua(d),e),e+=2*b,d=[]),d.push(a[f]);return c}
function sa(a){var b=a[0];va(b);var c=[];c.push(b&255);c.push(b>>8&255);c.push(y);c.push(0);for(b=3;b<a.length;b+=2){var d=va(a[b]),e=va(a[b+1]);c.push(e<<4|d)}for(;256>c.length;)c.push(0);return c}function ua(a){z=wa(a[1]<<8|a[0]);B=a[2];C=qa[B];for(var b=[z,wa(a[3]<<8|a[2])],c=4;c<a.length;c++){var d=a[c],e=d>>4;b.push(xa(e<<4^d));b.push(xa(e))}return b}function wa(a){return 32768<a?a-65536:a}
function va(a){var b=a-v;0<=b?a=0:(a=8,b=-b);var c=qa[y],d=c>>3;b>c&&(a|=4,b-=c,d+=c);c>>=1;b>c&&(a|=2,b-=c,d+=c);c>>=1;b>c&&(a|=1,d+=c);b=a;v=b&8?v-d:v+d;-32768>v?v=-32768:32767<v&&(v=32767);y+=pa[b&7];0>y?y=0:88<y&&(y=88);return a}function xa(a){var b=0;a&4&&(b+=C);a&2&&(b+=C>>1);a&1&&(b+=C>>2);b+=C>>3;a&8&&(b=-b);z+=b;32767<z?z=32767:-32767>z&&(z=-32767);B+=pa[a];0>B?B=0:88<B&&(B=88);C=qa[B];return z}
var ya=[1,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];function za(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++){var d=a[c];d=-32768==d?-32767:d;var e=~d>>8&128;e||(d*=-1);32635<d&&(d=32635);if(256<=d){var f=ya[d>>8&127];d=f<<4|d>>f+3&15}else d>>=4;b[c]=d^e^85}return b}
function Aa(a){for(var b=new Int16Array(a.length),c=0;c<a.length;c++){var d=a[c],e=0;d^=85;d&128&&(d&=-129,e=-1);var f=((d&240)>>4)+4;d=4!=f?1<<f|(d&15)<<f-4|1<<f-5:d<<1|1;b[c]=-8*(0===e?d:-d)}return b}
var Ba=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7],Ca=[0,132,396,924,1980,4092,8316,16764];function Da(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++){var d=a[c];var e=d>>8&128;0!=e&&(d=-d);32635<d&&(d=32635);d+=132;var f=Ba[d>>7&255];b[c]=~(e|f<<4|d>>f+3&15)}return b}function Ea(a){for(var b=new Int16Array(a.length),c=0;c<a.length;c++){var d=a[c];d=~d;var e=d>>4&7;e=Ca[e]+((d&15)<<e+3);0!=(d&128)&&(e=-e);b[c]=e}return b}
for(var D=new Uint8Array(256),E=0;64>E;E++)D["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(E)]=E;function Fa(a){var b=a.length,c=.75*a.length,d=0;"\x3d"===a[a.length-1]&&(c--,"\x3d"===a[a.length-2]&&c--);for(var e=new ArrayBuffer(c),f=new Uint8Array(e),l=0;l<b;l+=4){c=D[a.charCodeAt(l)];var h=D[a.charCodeAt(l+1)];var m=D[a.charCodeAt(l+2)];var p=D[a.charCodeAt(l+3)];f[d++]=c<<2|h>>4;f[d++]=(h&15)<<4|m>>2;f[d++]=(m&3)<<6|p&63}return e}
function Ga(a,b,c,d){c=void 0===c?0:c;d=void 0===d?a.length:d;if(d%b)throw Error("Bad buffer length.");for(;c<d;c+=b){var e=a,f=b,l=c;f--;for(var h=0;h<f;h++){var m=e[l+h];e[l+h]=e[l+f];e[l+f]=m;f--}}}function Ha(a,b){this.a=a;this.h=0;this.j=this.a;this.l=255;a=Math.pow(2,this.a);b?(this.g=a/2-1,this.m=-a/2):(this.g=a-1,this.m=0);this.j=(this.a-1|7)+1;b=8-(this.j-this.a);this.l=Math.pow(2,0<b?b:8)-1;this.h=8>this.a?1:Math.ceil(this.j/8)}
Ha.prototype.read=function(a,b){b=void 0===b?0:b;for(var c=0,d=0;d<this.h;d++)c+=a[b+d]*Math.pow(256,d);a=c;a>this.g&&(a-=2*this.g+2);return Ia(this,a)};Ha.prototype.write=function(a,b,c){c=void 0===c?0:c;var d=Ia(this,b);a[c]=8>this.a?0>d?d+Math.pow(2,this.a):d:d&255;c+=1;d=2;for(var e=this.h;d<e;d++,c++)a[c]=Math.floor(b/Math.pow(2,8*(d-1)))&255;8<this.a&&(a[c]=Math.floor(b/Math.pow(2,8*(this.h-1)))&this.l,c++);return c};
function Ia(a,b){if(b>a.g)throw Error("Overflow.");if(b<a.m)throw Error("Underflow.");return b}var Ja=0===(new Uint8Array((new Uint32Array([1])).buffer))[0],Ka=Ja?1:0,La=Ja?0:1,Ma=new Int8Array(8),F=new Uint32Array(Ma.buffer),Na=new Float32Array(Ma.buffer),Oa=new Float64Array(Ma.buffer),Qa,Ra,G={};
function Sa(a){if(!a)throw Error("Undefined type.");if(a.i){if(-1==[16,32,64].indexOf(a.b))throw Error("Bad float type.");}else if(1>a.b||53<a.b)throw Error("Bad type definition.");a.offset=8>a.b?1:Math.ceil(a.b/8);Qa=a.i?16==a.b?Ta:32==a.b?Ua:Va:Wa;Ra=a.i?16==a.b?Xa:32==a.b?Ya:Za:$a;G=new Ha(64==a.b?32:a.b,a.i?!1:a.w)}function Wa(a,b){return G.read(a,b)}function Ta(a,b){a=G.read(a,b);b=(a&31744)>>10;var c=a&1023;return(b?Math.pow(2,b-15)*(1+c/1024):c/1024*.00006103515625)*(a>>15?-1:1)}
function Ua(a,b){F[0]=G.read(a,b);return Na[0]}function Va(a,b){F[Ka]=G.read(a,b);F[La]=G.read(a,b+4);return Oa[0]}function $a(a,b,c){return G.write(a,b,c)}function Xa(a,b,c){Na[0]=b;var d=F[0];b=d>>16&32768;var e=d>>12&2047;d=d>>23&255;103<=d&&(b=(b|d-112<<10|e>>1)+(e&1));a[c++]=b&255;a[c++]=b>>>8&255;return c}function Ya(a,b,c){Na[0]=b;return G.write(a,F[0],c)}function Za(a,b,c){Oa[0]=b;c=G.write(a,F[Ka],c);return G.write(a,F[La],c)}
function H(a,b,c){b=void 0===b?0:b;c=void 0!==c?b+c:a.length;for(var d="";b<c;){var e=128,f=191,l=!1,h=a[b++];if(0<=h&&127>=h)d+=String.fromCharCode(h);else{var m=0;194<=h&&223>=h?m=1:224<=h&&239>=h?(m=2,224===a[b]&&(e=160),237===a[b]&&(f=159)):240<=h&&244>=h?(m=3,240===a[b]&&(e=144),244===a[b]&&(f=143)):l=!0;h&=(1<<8-m-1)-1;for(var p=0;p<m;p++){if(a[b]<e||a[b]>f)l=!0;h=h<<6|a[b]&63;b++}l?d+=String.fromCharCode(65533):65535>=h?d+=String.fromCharCode(h):(h-=65536,d+=String.fromCharCode((h>>10&1023)+
55296,(h&1023)+56320))}}return d}function I(a){for(var b=0,c=0,d=a.length;c<d;c++){var e=a.codePointAt(c);128>e||(2047>=e?b++:65535>=e?b+=2:1114111>=e&&(c++,b+=3));b++}b=new Uint8Array(b);d=c=0;for(e=a.length;d<e;d++){var f=a.codePointAt(d);if(128>f)b[c]=f,c++;else{var l=0,h=0;2047>=f?(l=1,h=192):65535>=f?(l=2,h=224):1114111>=f&&(l=3,h=240,d++);b[c]=(f>>6*l)+h;for(c++;0<l;)b[c]=128|f>>6*(l-1)&63,c++,l--}}return b}
function ab(a,b,c){c=void 0===c?0:c;a=I(a);for(var d=0,e=a.length;d<e;d++)b[c++]=a[d];return c}function J(a,b){var c=[];K([a],b,c,0);return c}function K(a,b,c,d){d=void 0===d?0:d;Sa(b);for(var e=0,f=a.length;e<f;e++){if(void 0===a[e])throw Error("Undefined value.");var l=a[e];if(null!==l&&-1==[Number,Boolean].indexOf(l.constructor))throw Error("Expected Number, Boolean or Null; found "+l.constructor);for(l=d+b.offset;d<l;)d=Ra(c,a[e],d);b.c&&Ga(c,b.offset,d-b.offset,d)}return d}
function M(a,b,c){c=void 0===c?0:c;Sa(b);if(b.offset+c>a.length)throw Error("Bad buffer length.");b.c&&Ga(a,b.offset,c,c+b.offset);var d=Qa(a,c);b.c&&Ga(a,b.offset,c,c+b.offset);return d}function bb(a,b){var c=void 0===c?a.length:c;var d=[];N(a,b,d,0,c);return d}function N(a,b,c,d,e){d=void 0===d?0:d;e=void 0===e?a.length:e;for(Sa(b);(e-d)%b.offset;)e--;for(var f=0;d<e;d+=b.offset,f++)c[f]=M(a,b,d)}var cb={4:17,8:1,"8a":6,"8m":7,16:1,24:1,32:1,"32f":3,64:3};
function O(a,b,c,d,e,f){return{container:f.container,chunkSize:36+e,format:"WAVE",bitDepth:a,fmt:{chunkId:"fmt ",chunkSize:16,audioFormat:cb[a]||65534,numChannels:b,sampleRate:c,byteRate:b*d*c,blockAlign:b*d,bitsPerSample:parseInt(a,10),cbSize:0,validBitsPerSample:0,dwChannelMask:0,subformat:[]}}}function db(a){if(!(cb[a.bitDepth]||8<parseInt(a.bitDepth,10)&&54>parseInt(a.bitDepth,10)))throw Error("Invalid bit depth.");}
function eb(a){var b=a.fmt.numChannels*a.fmt.bitsPerSample/8;if(1>a.fmt.numChannels||65535<b)throw Error("Invalid number of channels.");}function fb(a){var b=a.fmt.bitsPerSample/8*a.fmt.numChannels*a.fmt.sampleRate;if(1>a.fmt.sampleRate||4294967295<b)throw Error("Invalid sample rate.");}function P(a,b){var c=void 0===c?!0:c;a=Array.prototype.slice.call(I(a));if(c)for(c=a.length;c<b;c++)a.push(0);return a}
function gb(a){var b=Q,c=Q.a,d="";for(c=void 0===c?0:c;c<a.length;c++){b.a++;if(0===a[c])break;d+=H(a,c,1)}return d}function R(a,b){for(var c=Q,d="",e=0;e<b;e++)d+=H(a,c.a,1),c.a++;return d}function S(a,b){var c=Q,d=b.b/8;a=M(a,b,c.a);c.a+=d;return a}
function hb(a,b,c){var d=[];16<a.fmt.chunkSize&&(d=d.concat(J(a.fmt.cbSize,c)));18<a.fmt.chunkSize&&(d=d.concat(J(a.fmt.validBitsPerSample,c)));20<a.fmt.chunkSize&&(d=d.concat(J(a.fmt.dwChannelMask,b)));24<a.fmt.chunkSize&&(d=d.concat(J(a.fmt.subformat[0],b),J(a.fmt.subformat[1],b),J(a.fmt.subformat[2],b),J(a.fmt.subformat[3],b)));return d}
function ib(a,b,c){return[].concat(Array.prototype.slice.call(I(a.chunkId)),J(a.value.length+20,b),J(a.dwName,b),J(a.dwSampleLength,b),J(a.dwPurposeID,b),J(a.dwCountry,c),J(a.dwLanguage,c),J(a.dwDialect,c),J(a.dwCodePage,c),P(a.value,a.value.length))}var jb={b:32},T=0;function U(a,b,c){c=void 0===c?!1:c;for(var d=[],e=0;e<a.length;e++)if(a[e].chunkId==b)if(c)d.push(a[e]);else return a[e];return"LIST"==b?d.length?d:null:null}
function kb(a){for(var b=[],c=T;c<=a.length-8;)b.push(lb(a,c)),c+=8+b[b.length-1].chunkSize,c=c%2?c+1:c;return b}function lb(a,b){T+=4;var c={chunkId:H(a,b,4),chunkSize:mb(a,b)};"LIST"==c.chunkId?(c.format=H(a,b+8,4),T+=4,c.subChunks=kb(a)):(T=b+8+(c.chunkSize%2?c.chunkSize+1:c.chunkSize),c.chunkData={start:b+8,end:T});return c}function mb(a,b){T+=4;return M(a,jb,b+4)}var Q=new function(){this.a=0};
function V(){this.container="";this.chunkSize=0;this.format="";this.fmt={chunkId:"",chunkSize:0,audioFormat:0,numChannels:0,sampleRate:0,byteRate:0,blockAlign:0,bitsPerSample:0,cbSize:0,validBitsPerSample:0,dwChannelMask:0,subformat:[]};this.fact={chunkId:"",chunkSize:0,dwSampleLength:0};this.cue={chunkId:"",chunkSize:0,dwCuePoints:0,points:[]};this.smpl={chunkId:"",chunkSize:0,dwManufacturer:0,dwProduct:0,dwSamplePeriod:0,dwMIDIUnityNote:0,dwMIDIPitchFraction:0,dwSMPTEFormat:0,dwSMPTEOffset:0,dwNumSampleLoops:0,
dwSamplerData:0,loops:[]};this.bext={chunkId:"",chunkSize:0,description:"",originator:"",originatorReference:"",originationDate:"",originationTime:"",timeReference:[0,0],version:0,UMID:"",loudnessValue:0,loudnessRange:0,maxTruePeakLevel:0,maxMomentaryLoudness:0,maxShortTermLoudness:0,reserved:"",codingHistory:""};this.ds64={chunkId:"",chunkSize:0,riffSizeHigh:0,riffSizeLow:0,dataSizeHigh:0,dataSizeLow:0,originationTime:0,sampleCountHigh:0,sampleCountLow:0};this.data={chunkId:"",chunkSize:0,samples:new Uint8Array(0)};
this.LIST=[];this.junk={chunkId:"",chunkSize:0,chunkData:[]}}function r(a){a=void 0===a?null:a;V.call(this);this.bitDepth="0";this.a={};a&&this.fromBuffer(a)}r.prototype=aa(V.prototype);r.prototype.constructor=r;if(da)da(r,V);else for(var W in V)if("prototype"!=W)if(Object.defineProperties){var nb=Object.getOwnPropertyDescriptor(V,W);nb&&Object.defineProperty(r,W,nb)}else r[W]=V[W];r.a=V.prototype;g=r.prototype;
g.getSample=function(a){a*=this.a.b/8;if(a+this.a.b/8>this.data.samples.length)throw Error("Range error");return M(this.data.samples.slice(a,a+this.a.b/8),this.a)};g.setSample=function(a,b){a*=this.a.b/8;if(a+this.a.b/8>this.data.samples.length)throw Error("Range error");K([b],this.a,this.data.samples,void 0===a?0:a)};
g.fromScratch=function(a,b,c,d,e){e=void 0===e?{}:e;e.container||(e.container="RIFF");this.container=e.container;this.bitDepth=c;if(0<d.length&&d[0].constructor===Array){for(var f=[],l=0,h=d[0].length;l<h;l++)for(var m=0,p=d.length;m<p;m++)f.push(d[m][l]);d=f}ob(this);f=this.a.b/8;this.data.samples=new Uint8Array(d.length*f);K(d,this.a,this.data.samples);d=this.data.samples.length;"4"==c?(a=O(c,a,b,f,d,e),a.chunkSize=40+d,a.fmt.chunkSize=20,a.fmt.byteRate=4055,a.fmt.blockAlign=256,a.fmt.bitsPerSample=
4,a.fmt.cbSize=2,a.fmt.validBitsPerSample=505,a.fact={chunkId:"fact",chunkSize:4,dwSampleLength:2*d}):"8a"==c||"8m"==c?(a=O(c,a,b,f,d,e),a.chunkSize=40+d,a.fmt.chunkSize=20,a.fmt.cbSize=2,a.fmt.validBitsPerSample=8,a.fact={chunkId:"fact",chunkSize:4,dwSampleLength:d}):-1==Object.keys(cb).indexOf(c)||2<a?(b=O(c,a,b,f,d,e),b.chunkSize=60+d,b.fmt.chunkSize=40,b.fmt.bitsPerSample=(parseInt(c,10)-1|7)+1,b.fmt.cbSize=22,b.fmt.validBitsPerSample=parseInt(c,10),c=0,1===a?c=4:2===a?c=3:4===a?c=51:6===a?c=
63:8===a&&(c=1599),b.fmt.dwChannelMask=c,b.fmt.subformat=[1,1048576,2852126848,1905997824],a=b):a=O(c,a,b,f,d,e);pb(this);this.chunkSize=a.chunkSize;this.format=a.format;this.fmt=a.fmt;a.fact&&(this.fact=a.fact);this.data.chunkId="data";this.data.chunkSize=this.data.samples.length;db(this);eb(this);fb(this)};
g.fromBuffer=function(a,b){b=void 0===b?!0:b;pb(this);var c=b;Q.a=0;b={b:32,c:!1};var d={b:16,c:!1};Q.a=0;this.container=R(a,4);if(-1===["RIFF","RIFX","RF64"].indexOf(this.container))throw Error("Not a supported format.");d.c="RIFX"===this.container;b.c=d.c;this.chunkSize=S(a,b);this.format=R(a,4);if("WAVE"!=this.format)throw Error('Could not find the "WAVE" format identifier');T=0;T+=4;jb.c="RIFX"==H(a,0,4);T+=4;mb(a,0);var e=kb(a);var f=U(e,"ds64");if(f)Q.a=f.chunkData.start,this.ds64.chunkId=f.chunkId,
this.ds64.chunkSize=f.chunkSize,this.ds64.riffSizeHigh=S(a,b),this.ds64.riffSizeLow=S(a,b),this.ds64.dataSizeHigh=S(a,b),this.ds64.dataSizeLow=S(a,b),this.ds64.originationTime=S(a,b),this.ds64.sampleCountHigh=S(a,b),this.ds64.sampleCountLow=S(a,b);else if("RF64"==this.container)throw Error('Could not find the "ds64" chunk');if(f=U(e,"fmt "))Q.a=f.chunkData.start,this.fmt.chunkId=f.chunkId,this.fmt.chunkSize=f.chunkSize,this.fmt.audioFormat=S(a,d),this.fmt.numChannels=S(a,d),this.fmt.sampleRate=S(a,
b),this.fmt.byteRate=S(a,b),this.fmt.blockAlign=S(a,d),this.fmt.bitsPerSample=S(a,d),16<this.fmt.chunkSize&&(this.fmt.cbSize=S(a,d),18<this.fmt.chunkSize&&(this.fmt.validBitsPerSample=S(a,d),20<this.fmt.chunkSize&&(this.fmt.dwChannelMask=S(a,b),this.fmt.subformat=[S(a,b),S(a,b),S(a,b),S(a,b)])));else throw Error('Could not find the "fmt " chunk');if(f=U(e,"fact"))Q.a=f.chunkData.start,this.fact.chunkId=f.chunkId,this.fact.chunkSize=f.chunkSize,this.fact.dwSampleLength=S(a,b);if(f=U(e,"bext"))Q.a=
f.chunkData.start,this.bext.chunkId=f.chunkId,this.bext.chunkSize=f.chunkSize,this.bext.description=R(a,256),this.bext.originator=R(a,32),this.bext.originatorReference=R(a,32),this.bext.originationDate=R(a,10),this.bext.originationTime=R(a,8),this.bext.timeReference=[S(a,b),S(a,b)],this.bext.version=S(a,d),this.bext.UMID=R(a,64),this.bext.loudnessValue=S(a,d),this.bext.loudnessRange=S(a,d),this.bext.maxTruePeakLevel=S(a,d),this.bext.maxMomentaryLoudness=S(a,d),this.bext.maxShortTermLoudness=S(a,d),
this.bext.reserved=R(a,180),this.bext.codingHistory=R(a,this.bext.chunkSize-602);if(f=U(e,"cue "))for(Q.a=f.chunkData.start,this.cue.chunkId=f.chunkId,this.cue.chunkSize=f.chunkSize,this.cue.dwCuePoints=S(a,b),f=0;f<this.cue.dwCuePoints;f++)this.cue.points.push({dwName:S(a,b),dwPosition:S(a,b),fccChunk:R(a,4),dwChunkStart:S(a,b),dwBlockStart:S(a,b),dwSampleOffset:S(a,b)});if(f=U(e,"smpl"))for(Q.a=f.chunkData.start,this.smpl.chunkId=f.chunkId,this.smpl.chunkSize=f.chunkSize,this.smpl.dwManufacturer=
S(a,b),this.smpl.dwProduct=S(a,b),this.smpl.dwSamplePeriod=S(a,b),this.smpl.dwMIDIUnityNote=S(a,b),this.smpl.dwMIDIPitchFraction=S(a,b),this.smpl.dwSMPTEFormat=S(a,b),this.smpl.dwSMPTEOffset=S(a,b),this.smpl.dwNumSampleLoops=S(a,b),this.smpl.dwSamplerData=S(a,b),f=0;f<this.smpl.dwNumSampleLoops;f++)this.smpl.loops.push({dwName:S(a,b),dwType:S(a,b),dwStart:S(a,b),dwEnd:S(a,b),dwFraction:S(a,b),dwPlayCount:S(a,b)});if(f=U(e,"data"))this.data.chunkId="data",this.data.chunkSize=f.chunkSize,c&&(this.data.samples=
a.slice(f.chunkData.start,f.chunkData.end));else throw Error('Could not find the "data" chunk');if(c=U(e,"junk"))this.junk={chunkId:c.chunkId,chunkSize:c.chunkSize,chunkData:[].slice.call(a.slice(c.chunkData.start,c.chunkData.end))};e=U(e,"LIST",!0);if(null!==e)for(c=0;c<e.length;c++){f=e[c];this.LIST.push({chunkId:f.chunkId,chunkSize:f.chunkSize,format:f.format,subChunks:[]});for(var l=0;l<f.subChunks.length;l++){var h=f.subChunks[l],m=f.format,p=a,L=b,x=d;"adtl"==m?-1<["labl","note","ltxt"].indexOf(h.chunkId)&&
(Q.a=h.chunkData.start,m={chunkId:h.chunkId,chunkSize:h.chunkSize,dwName:S(p,L)},"ltxt"==h.chunkId&&(m.dwSampleLength=S(p,L),m.dwPurposeID=S(p,L),m.dwCountry=S(p,x),m.dwLanguage=S(p,x),m.dwDialect=S(p,x),m.dwCodePage=S(p,x)),m.value=gb(p),this.LIST[this.LIST.length-1].subChunks.push(m)):"INFO"==m&&(Q.a=h.chunkData.start,this.LIST[this.LIST.length-1].subChunks.push({chunkId:h.chunkId,chunkSize:h.chunkSize,value:gb(p)}))}}3===this.fmt.audioFormat&&32===this.fmt.bitsPerSample?this.bitDepth="32f":6===
this.fmt.audioFormat?this.bitDepth="8a":7===this.fmt.audioFormat?this.bitDepth="8m":this.bitDepth=this.fmt.bitsPerSample.toString();ob(this)};
g.toBuffer=function(){db(this);eb(this);fb(this);var a={b:32,c:!1},b={b:16,c:!1};b.c="RIFX"===this.container;a.c=b.c;var c=[];c=this.junk.chunkId?c.concat(Array.prototype.slice.call(I(this.junk.chunkId)),J(this.junk.chunkData.length,a),this.junk.chunkData):c;var d=[];this.ds64.chunkId&&(d=d.concat(Array.prototype.slice.call(I(this.ds64.chunkId)),J(this.ds64.chunkSize,a),J(this.ds64.riffSizeHigh,a),J(this.ds64.riffSizeLow,a),J(this.ds64.dataSizeHigh,a),J(this.ds64.dataSizeLow,a),J(this.ds64.originationTime,
a),J(this.ds64.sampleCountHigh,a),J(this.ds64.sampleCountLow,a)));var e=[];for(f in this.bext)if(this.bext.hasOwnProperty(f)&&this.bext[f]&&"timeReference"!=f){this.bext.chunkId="bext";break}if(this.bext.timeReference[0]||this.bext.timeReference[1])this.bext.chunkId="bext";this.bext.chunkId&&(this.bext.chunkSize=602+this.bext.codingHistory.length,e=e.concat(Array.prototype.slice.call(I(this.bext.chunkId)),J(602+this.bext.codingHistory.length,a),P(this.bext.description,256),P(this.bext.originator,
32),P(this.bext.originatorReference,32),P(this.bext.originationDate,10),P(this.bext.originationTime,8),J(this.bext.timeReference[0],a),J(this.bext.timeReference[1],a),J(this.bext.version,b),Array.prototype.slice.call(P(this.bext.UMID,64)),J(this.bext.loudnessValue,b),J(this.bext.loudnessRange,b),J(this.bext.maxTruePeakLevel,b),J(this.bext.maxMomentaryLoudness,b),J(this.bext.maxShortTermLoudness,b),P(this.bext.reserved,180),P(this.bext.codingHistory,this.bext.codingHistory.length)));var f=e;e=[];if(this.fmt.chunkId)e=
e.concat(Array.prototype.slice.call(I(this.fmt.chunkId)),J(this.fmt.chunkSize,a),J(this.fmt.audioFormat,b),J(this.fmt.numChannels,b),J(this.fmt.sampleRate,a),J(this.fmt.byteRate,a),J(this.fmt.blockAlign,b),J(this.fmt.bitsPerSample,b),hb(this,a,b));else throw Error('Could not find the "fmt " chunk');var l=[];this.fact.chunkId&&(l=l.concat(Array.prototype.slice.call(I(this.fact.chunkId)),J(this.fact.chunkSize,a),J(this.fact.dwSampleLength,a)));var h=Array.prototype.slice.call(I(this.data.chunkId)),
m=J(this.data.samples.length,a),p=this.data.samples;var L=[];if(this.cue.chunkId){var x=[];for(var q=0;q<this.cue.dwCuePoints;q++)x=x.concat(J(this.cue.points[q].dwName,a),J(this.cue.points[q].dwPosition,a),Array.prototype.slice.call(I(this.cue.points[q].fccChunk)),J(this.cue.points[q].dwChunkStart,a),J(this.cue.points[q].dwBlockStart,a),J(this.cue.points[q].dwSampleOffset,a));L=L.concat(Array.prototype.slice.call(I(this.cue.chunkId)),J(x.length+4,a),J(this.cue.dwCuePoints,a),x)}x=[];if(this.smpl.chunkId){q=
[];for(var u=0;u<this.smpl.dwNumSampleLoops;u++)q=q.concat(J(this.smpl.loops[u].dwName,a),J(this.smpl.loops[u].dwType,a),J(this.smpl.loops[u].dwStart,a),J(this.smpl.loops[u].dwEnd,a),J(this.smpl.loops[u].dwFraction,a),J(this.smpl.loops[u].dwPlayCount,a));x=x.concat(Array.prototype.slice.call(I(this.smpl.chunkId)),J(q.length+36,a),J(this.smpl.dwManufacturer,a),J(this.smpl.dwProduct,a),J(this.smpl.dwSamplePeriod,a),J(this.smpl.dwMIDIUnityNote,a),J(this.smpl.dwMIDIPitchFraction,a),J(this.smpl.dwSMPTEFormat,
a),J(this.smpl.dwSMPTEOffset,a),J(this.smpl.dwNumSampleLoops,a),J(this.smpl.dwSamplerData,a),q)}q=[];for(u=0;u<this.LIST.length;u++){var t=this.LIST[u].subChunks;for(var Pa=this.LIST[u].format,X=a,wb=b,A=[],w=0;w<t.length;w++)"INFO"==Pa?(A=A.concat(Array.prototype.slice.call(I(t[w].chunkId)),J(t[w].value.length+1,X),P(t[w].value,t[w].value.length)),A.push(0)):"adtl"==Pa&&(-1<["labl","note"].indexOf(t[w].chunkId)?(A=A.concat(Array.prototype.slice.call(I(t[w].chunkId)),J(t[w].value.length+4+1,X),J(t[w].dwName,
X),P(t[w].value,t[w].value.length)),A.push(0)):"ltxt"==t[w].chunkId&&(A=A.concat(ib(t[w],X,wb)))),A.length%2&&A.push(0);t=A;q=q.concat(Array.prototype.slice.call(I(this.LIST[u].chunkId)),J(t.length+4,a),Array.prototype.slice.call(I(this.LIST[u].format)),t)}b=[c,d,f,e,l,h,m,p,L,x,q];for(d=c=0;d<b.length;d++)c+=b[d].length;d=new Uint8Array(c+12);f=ab(this.container,d,0);f=K([c+4],a,d,void 0===f?0:f);f=ab(this.format,d,f);for(a=0;a<b.length;a++)d.set(b[a],f),f+=b[a].length;return d};g.fromBase64=function(a){this.fromBuffer(new Uint8Array(Fa(a)))};
g.toBase64=function(){var a=this.toBuffer();a=new Uint8Array(a,0,a.length);for(var b=a.length,c="",d=0;d<b;d+=3)c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a[d]>>2],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(a[d]&3)<<4|a[d+1]>>4],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(a[d+1]&15)<<2|a[d+2]>>6],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a[d+2]&63];2===b%3?c=c.substring(0,c.length-1)+"\x3d":
1===b%3&&(c=c.substring(0,c.length-2)+"\x3d\x3d");return c};g.toDataURI=function(){return"data:audio/wav;base64,"+this.toBase64()};g.fromDataURI=function(a){this.fromBase64(a.replace("data:audio/wav;base64,",""))};g.toRIFF=function(){this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,this.bitDepth,bb(this.data.samples,this.a))};g.toRIFX=function(){this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,this.bitDepth,bb(this.data.samples,this.a),{container:"RIFX"})};
g.toBitDepth=function(a,b){var c=a,d=this.bitDepth;void 0===b||b||("32f"!=a&&(c=this.a.b.toString()),d=this.a.b);qb(this);var e=this.data.samples.length/(this.a.b/8);b=new Float64Array(e+1);e=new Float64Array(e+1);N(this.data.samples,this.a,b);if("32f"==d||"64"==d)for(var f=0,l=b.length;f<l;f++)1<b[f]?b[f]=1:-1>b[f]&&(b[f]=-1);var h=d;d=c;oa(h);oa(d);f=na(h,d);l={v:Math.pow(2,parseInt(h,10))/2,s:Math.pow(2,parseInt(d,10))/2,u:Math.pow(2,parseInt(h,10))/2-1,o:Math.pow(2,parseInt(d,10))/2-1};c=b.length;
if("8"==h)for(h=0;h<c;h++)e[h]=b[h]-=128;for(h=0;h<c;h++)e[h]=f(b[h],l);if("8"==d)for(b=0;b<c;b++)e[b]=e[b]+=128;this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,a,e,{container:Y(this)})};
g.toIMAADPCM=function(){if(8E3!==this.fmt.sampleRate)throw Error("Only 8000 Hz files can be compressed as IMA-ADPCM.");if(1!==this.fmt.numChannels)throw Error("Only mono files can be compressed as IMA-ADPCM.");rb(this);var a=new Int16Array(this.data.samples.length/2);N(this.data.samples,this.a,a);this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"4",ra(a),{container:Y(this)})};
g.fromIMAADPCM=function(a){a=void 0===a?"16":a;this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"16",ta(this.data.samples,this.fmt.blockAlign),{container:Y(this)});"16"!=a&&this.toBitDepth(a)};g.toALaw=function(){rb(this);var a=new Int16Array(this.data.samples.length/2);N(this.data.samples,this.a,a);this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"8a",za(a),{container:Y(this)})};
g.fromALaw=function(a){a=void 0===a?"16":a;this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"16",Aa(this.data.samples),{container:Y(this)});"16"!=a&&this.toBitDepth(a)};g.toMuLaw=function(){rb(this);var a=new Int16Array(this.data.samples.length/2);N(this.data.samples,this.a,a);this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"8m",Da(a),{container:Y(this)})};
g.fromMuLaw=function(a){a=void 0===a?"16":a;this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"16",Ea(this.data.samples),{container:Y(this)});"16"!=a&&this.toBitDepth(a)};
g.setTag=function(a,b){if(a.constructor!==String)throw Error("Invalid tag name.");if(4>a.length)for(var c=0,d=4-a.length;c<d;c++)a+=" ";c=sb(this,a);null!==c.f?(this.LIST[c.LIST].subChunks[c.f].chunkSize=b.length+1,this.LIST[c.LIST].subChunks[c.f].value=b):null!==c.LIST?this.LIST[c.LIST].subChunks.push({chunkId:a,chunkSize:b.length+1,value:b}):(this.LIST.push({chunkId:"LIST",chunkSize:b.length+9,format:"INFO",subChunks:[]}),this.LIST[this.LIST.length-1].subChunks.push({chunkId:a,chunkSize:b.length+
1,value:b}))};g.getTag=function(a){a=sb(this,a);return null!==a.f?this.LIST[a.LIST].subChunks[a.f].value:null};g.listTags=function(){var a=null;for(var b=0,c=this.LIST.length;b<c;b++)if("INFO"===this.LIST[b].format){a=b;break}b={};if(null!==a){c=0;for(var d=this.LIST[a].subChunks.length;c<d;c++)b[this.LIST[a].subChunks[c].chunkId]=this.LIST[a].subChunks[c].value}return b};g.deleteTag=function(a){a=sb(this,a);return null!==a.f?(this.LIST[a.LIST].subChunks.splice(a.f,1),!0):!1};
g.setCuePoint=function(a,b){b=void 0===b?"":b;this.cue.chunkId="cue ";a=a*this.fmt.sampleRate/1E3;var c=tb(this);ub(this);var d=this.cue.points.length;this.cue.points=[];var e=!1;if(0===d)Z(this,a,1,b);else{for(var f=0;f<d;f++)c[f].dwPosition>a&&!e?(Z(this,a,f+1,b),Z(this,c[f].dwPosition,f+2,c[f].label),e=!0):Z(this,c[f].dwPosition,f+1,c[f].label);e||Z(this,a,this.cue.points.length+1,b)}this.cue.dwCuePoints=this.cue.points.length};
g.deleteCuePoint=function(a){this.cue.chunkId="cue ";var b=tb(this);ub(this);var c=this.cue.points.length;this.cue.points=[];for(var d=0;d<c;d++)d+1!==a&&Z(this,b[d].dwPosition,d+1,b[d].label);this.cue.dwCuePoints=this.cue.points.length;this.cue.dwCuePoints?this.cue.chunkId="cue ":(this.cue.chunkId="",ub(this))};g.listCuePoints=function(){for(var a=tb(this),b=0,c=a.length;b<c;b++)a[b].milliseconds=a[b].dwPosition/this.fmt.sampleRate*1E3;return a};
g.updateLabel=function(a,b){var c=vb(this);if(null!==c)for(var d=0,e=this.LIST[c].subChunks.length;d<e;d++)this.LIST[c].subChunks[d].dwName==a&&(this.LIST[c].subChunks[d].value=b)};
function Z(a,b,c,d){a.cue.points.push({dwName:c,dwPosition:b,fccChunk:"data",dwChunkStart:0,dwBlockStart:0,dwSampleOffset:b});b=vb(a);null===b&&(a.LIST.push({chunkId:"LIST",chunkSize:4,format:"adtl",subChunks:[]}),b=a.LIST.length-1);b=null===b?0:b;a.LIST[b].subChunks.push({chunkId:"labl",chunkSize:d.length,dwName:c,value:d});a.LIST[b].chunkSize+=d.length+13}
function tb(a){for(var b=[],c=0,d=a.cue.points.length;c<d;c++){a:{var e=vb(a);if(null!==e)for(var f=0,l=a.LIST[e].subChunks.length;f<l;f++)if(a.LIST[e].subChunks[f].dwName==a.cue.points[c].dwName){e=a.LIST[e].subChunks[f].value;break a}e=""}b.push({dwPosition:a.cue.points[c].dwPosition,label:e})}return b}function ub(a){for(var b=0,c=a.LIST.length;b<c;b++)"adtl"==a.LIST[b].format&&a.LIST.splice(b)}function vb(a){for(var b=0,c=a.LIST.length;b<c;b++)if("adtl"==a.LIST[b].format)return b;return null}
function sb(a,b){for(var c={LIST:null,f:null},d=0,e=a.LIST.length;d<e;d++)if("INFO"==a.LIST[d].format){c.LIST=d;e=0;for(var f=a.LIST[d].subChunks.length;e<f;e++)if(a.LIST[d].subChunks[e].chunkId==b){c.f=e;break}break}return c}function pb(a){a.fmt.cbSize=0;a.fmt.validBitsPerSample=0;a.fact.chunkId="";a.ds64.chunkId=""}function rb(a){qb(a);"16"!=a.bitDepth&&a.toBitDepth("16")}function qb(a){"8a"==a.bitDepth?a.fromALaw():"8m"==a.bitDepth?a.fromMuLaw():"4"==a.bitDepth&&a.fromIMAADPCM()}
function ob(a){a.a={b:(parseInt(a.bitDepth,10)-1|7)+1,i:"32f"==a.bitDepth||"64"==a.bitDepth,w:"8"!=a.bitDepth,c:"RIFX"==a.container};-1<["4","8a","8m"].indexOf(a.bitDepth)&&(a.a.b=8,a.a.w=!1)}function Y(a){return"RF64"==a.container?"RIFF":a.container};var module=module||{};module.exports=exports;var define=define||function(){};define(["exports"],function(exports){return module.exports;});
