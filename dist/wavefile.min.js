var na="function"==typeof Object.create?Object.create:function(e){function m(){}m.prototype=e;return new m},N;if("function"==typeof Object.setPrototypeOf)N=Object.setPrototypeOf;else{var O;a:{var oa={K:!0},P={};try{P.__proto__=oa;O=P.K;break a}catch(e){}O=!1}N=O?function(e,m){e.__proto__=m;if(e.__proto__!==m)throw new TypeError(e+" is not extensible");return e}:null}var X=N;
function Y(e,m){e.prototype=na(m.prototype);e.prototype.constructor=e;if(X)X(e,m);else for(var l in m)if("prototype"!=l)if(Object.defineProperties){var n=Object.getOwnPropertyDescriptor(m,l);n&&Object.defineProperty(e,l,n)}else e[l]=m[l];e.O=m.prototype}var pa="function"==typeof Object.defineProperties?Object.defineProperty:function(e,m,l){e!=Array.prototype&&e!=Object.prototype&&(e[m]=l.value)},qa="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;
function Z(e,m){if(m){var l=qa;e=e.split(".");for(var n=0;n<e.length-1;n++){var p=e[n];p in l||(l[p]={});l=l[p]}e=e[e.length-1];n=l[e];m=m(n);m!=n&&null!=m&&pa(l,e,{configurable:!0,writable:!0,value:m})}}Z("Object.is",function(e){return e?e:function(e,l){return e===l?0!==e||1/e===1/l:e!==e&&l!==l}});
Z("Array.prototype.includes",function(e){return e?e:function(e,l){var m=this;m instanceof String&&(m=String(m));var p=m.length;l=l||0;for(0>l&&(l=Math.max(l+p,0));l<p;l++){var u=m[l];if(u===e||Object.is(u,e))return!0}return!1}});
Z("String.prototype.codePointAt",function(e){return e?e:function(e){if(null==this)throw new TypeError("The 'this' value for String.prototype.codePointAt must not be null or undefined");var l=this.length;e=Number(e)||0;if(0<=e&&e<l){e|=0;var m=this.charCodeAt(e);if(55296>m||56319<m||e+1===l)return m;e=this.charCodeAt(e+1);return 56320>e||57343<e?m:1024*(m-55296)+e+9216}}});
var Na=function(){function e(a){a=void 0===a?null:a;var b=m.call(this)||this;b.bitDepth="0";b.dataType={};a&&b.fromBuffer(a);return b}function m(){this.container="";this.chunkSize=0;this.format="";this.fmt={chunkId:"",chunkSize:0,audioFormat:0,numChannels:0,sampleRate:0,byteRate:0,blockAlign:0,bitsPerSample:0,cbSize:0,validBitsPerSample:0,dwChannelMask:0,subformat:[]};this.fact={chunkId:"",chunkSize:0,dwSampleLength:0};this.cue={chunkId:"",chunkSize:0,dwCuePoints:0,points:[]};this.smpl={chunkId:"",
chunkSize:0,dwManufacturer:0,dwProduct:0,dwSamplePeriod:0,dwMIDIUnityNote:0,dwMIDIPitchFraction:0,dwSMPTEFormat:0,dwSMPTEOffset:0,dwNumSampleLoops:0,dwSamplerData:0,loops:[]};this.bext={chunkId:"",chunkSize:0,description:"",originator:"",originatorReference:"",originationDate:"",originationTime:"",timeReference:[0,0],version:0,UMID:"",loudnessValue:0,loudnessRange:0,maxTruePeakLevel:0,maxMomentaryLoudness:0,maxShortTermLoudness:0,reserved:"",codingHistory:""};this.ds64={chunkId:"",chunkSize:0,riffSizeHigh:0,
riffSizeLow:0,dataSizeHigh:0,dataSizeLow:0,originationTime:0,sampleCountHigh:0,sampleCountLow:0};this.data={chunkId:"",chunkSize:0,samples:new Uint8Array(0)};this.LIST=[];this.junk={chunkId:"",chunkSize:0,chunkData:[]}}function l(){this.b=0}function n(a,b,c){if(b){if(!a||16!==a&&32!==a&&64!==a)throw Error("Unsupported type: float, bits: "+a);a=this.g(a)}else{if(!a||1>a||53<a)throw Error("Unsupported type: int, bits: "+a);a=c?new p(a):new u(a)}this.a=a}function p(a){a=u.call(this,a)||this;a.max=Math.pow(2,
a.f)/2-1;a.min=-a.max-1;return a}function u(a){this.f=a;this.b=8>a?1:Math.ceil(a/8);this.max=Math.pow(2,a)-1;this.min=0;a=8-((a-1|7)+1-a);this.j=Math.pow(2,0<a?a:8)-1}function E(a,b){this.b=a;this.c=b;this.a=(1<<a-1)-1;this.j=Math.ceil((a+b)/8);this.o=Math.pow(2,this.a+1);this.s=a+b;this.u=Math.pow(2,-(8*this.j-1-a))}function ra(a){var b=a.length,c=.75*a.length,d=0;"\x3d"===a[a.length-1]&&(c--,"\x3d"===a[a.length-2]&&c--);for(var g=new ArrayBuffer(c),f=new Uint8Array(g),e=0;e<b;e+=4){c=H[a.charCodeAt(e)];
var h=H[a.charCodeAt(e+1)];var k=H[a.charCodeAt(e+2)];var l=H[a.charCodeAt(e+3)];f[d++]=c<<2|h>>4;f[d++]=(h&15)<<4|k>>2;f[d++]=(k&3)<<6|l&63}return g}function ta(a,b){return a=0<a?parseInt(a/b.D*b.B,10):parseInt(a/b.F*b.C,10)}function ua(a,b){return parseInt(0<a?a*b.B:a*b.C,10)}function va(a,b){return 0<a?a/b.D:a/b.F}function wa(a){aa[0]=a;return aa[0]}function xa(a,b){function c(a){return a}a!=b&&(["32f","64"].includes(a)?["32f","64"].includes(b)?c=wa:c=ua:c=["32f","64"].includes(b)?va:ta);return c}
function ba(a){if("32f"!=a&&"64"!=a&&("8">parseInt(a,10)||"53"<parseInt(a,10)))throw Error("Invalid bit depth.");}function ya(a){for(var b=new Uint8Array(a.length/2+512),c=[],d=0,g=0;g<a.length;g++)0==g%505&&0!=g&&(b.set(za(c),d),d+=256,c=[]),c.push(a[g]);return b}function Aa(a,b){b=void 0===b?256:b;for(var c=new Int16Array(2*a.length),d=[],g=0,f=0;f<a.length;f++)0==f%b&&0!=f&&(c.set(Ba(d),g),g+=2*b,d=[]),d.push(a[f]);return c}function za(a){var b=a[0];Q(b);var c=[];c.push(b&255);c.push(b>>8&255);
c.push(F);c.push(0);for(b=3;b<a.length;b+=2){var d=Q(a[b]),g=Q(a[b+1]);c.push(g<<4|d)}for(;256>c.length;)c.push(0);return c}function Ba(a){A=ca(a[1]<<8|a[0]);B=a[2];G=R[B];for(var b=[A,ca(a[3]<<8|a[2])],c=4;c<a.length;c++){var d=a[c],g=d>>4;b.push(da(g<<4^d));b.push(da(g))}return b}function ca(a){return 32768<a?a-65536:a}function Q(a){var b=a-C;0<=b?a=0:(a=8,b=-b);var c=R[F],d=c>>3;b>c&&(a|=4,b-=c,d+=c);c>>=1;b>c&&(a|=2,b-=c,d+=c);c>>=1;b>c&&(a|=1,d+=c);b=a;C=b&8?C-d:C+d;-32768>C?C=-32768:32767<C&&
(C=32767);F+=ea[b&7];0>F?F=0:88<F&&(F=88);return a}function da(a){var b=0;a&4&&(b+=G);a&2&&(b+=G>>1);a&1&&(b+=G>>2);b+=G>>3;a&8&&(b=-b);A+=b;32767<A?A=32767:-32767>A&&(A=-32767);B+=ea[a];0>B?B=0:88<B&&(B=88);G=R[B];return A}function Ca(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++){var d=a[c];d=-32768==d?-32767:d;var g=~d>>8&128;g||(d*=-1);32635<d&&(d=32635);if(256<=d){var f=Da[d>>8&127];d=f<<4|d>>f+3&15}else d>>=4;b[c]=d^g^85}return b}function Ea(a){for(var b=new Int16Array(a.length),
c=0;c<a.length;c++){var d=a[c],g=0;d^=85;d&128&&(d&=-129,g=-1);var f=((d&240)>>4)+4;d=4!=f?1<<f|(d&15)<<f-4|1<<f-5:d<<1|1;b[c]=-8*(0===g?d:-d)}return b}function Fa(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++){var d=a[c];var g=d>>8&128;0!=g&&(d=-d);32635<d&&(d=32635);d+=132;var f=Ga[d>>7&255];b[c]=~(g|f<<4|d>>f+3&15)}return b}function Ha(a){for(var b=new Int16Array(a.length),c=0;c<a.length;c++){var d=a[c];d=~d;var g=d>>4&7;g=Ia[g]+((d&15)<<g+3);0!=(d&128)&&(g=-g);b[c]=g}return b}function S(a,
b,c,d){d=void 0===d?a.length:d;if(d%b)throw Error("Bad buffer length.");for(c=void 0===c?0:c;c<d;c+=b){var g=a,f=b,e=c;f--;for(var h=0;h<f;h++){var k=g[e+h];g[e+h]=g[e+f];g[e+f]=k;f--}}}function T(a,b,c){c=void 0===c?0:c;for(var d=0,g=a.length;d<g;d++){var f=a.codePointAt(d);if(128>f)b[c]=f,c++;else{var e=0,h=0;2047>=f?(e=1,h=192):65535>=f?(e=2,h=224):1114111>=f&&(e=3,h=240,d++);b[c]=(f>>6*e)+h;for(c++;0<e;)b[c]=128|f>>6*(e-1)&63,c++,e--}}return c}function J(a,b,c){c=void 0===c?a.length:c;var d=void 0===
b?0:b;c=void 0===c?a.length:c;b="";for(d=void 0===d?0:d;d<c;){var g=128,f=191,e=!1,h=a[d++];if(0<=h&&127>=h)b+=String.fromCharCode(h);else{var k=0;194<=h&&223>=h?k=1:224<=h&&239>=h?(k=2,224===a[d]&&(g=160),237===a[d]&&(f=159)):240<=h&&244>=h?(k=3,240===a[d]&&(g=144),244===a[d]&&(f=143)):e=!0;h&=(1<<8-k-1)-1;for(var l=0;l<k;l++){if(a[d]<g||a[d]>f)e=!0;h=h<<6|a[d]&63;d++}e?b+=String.fromCharCode(65533):65535>=h?b+=String.fromCharCode(h):(h-=65536,b+=String.fromCharCode((h>>10&1023)+55296,(h&1023)+56320))}}return b}
function q(a){var b=[];T(a,b,0);return b}function k(a,b){var c=[];K([a],b,c,0);return c}function K(a,b,c,d){d=void 0===d?0:d;b=b||{};var g=new n(b.f,b.v,b.A),f=Math.ceil(b.f/8),e=0;try{for(var h=a.length;e<h;e++){var k=a[e];if(void 0===k||null===k)throw Error("Argument is not a valid number");if(k.constructor!=Number&&k.constructor!=Boolean)throw Error("Argument is not a valid number");for(var l=d+f;d<l;)d=g.b(c,a[e],d);b.h&&S(c,f,d-f,d)}}catch(Ja){a=a[e];if(b.v||Infinity!==a&&-Infinity!==a&&a===
a)throw Error(Ja.message+" at input index "+e);throw Error("Argument is not a integer at input index "+e);}return d}function U(a,b,c){c=void 0===c?0:c;return V(a,b,c,c+Math.ceil(b.f/8),!0)[0]}function V(a,b,c,d,g){d=void 0===d?a.length:d;var f=[];I(a,b,f,void 0===c?0:c,d,void 0===g?!1:g);return f}function I(a,b,c,d,g,f){d=void 0===d?0:d;g=void 0===g?a.length:g;f=void 0===f?!1:f;b=b||{};var e=new n(b.f,b.v,b.A),h=Math.ceil(b.f/8),k=(g-d)%h;if(f&&(k||a.length<h))throw Error("Bad buffer length");g-=
k;f=0;try{b.h&&S(a,h,d,g);for(k=d;k<g;k+=h,f++)c[f]=e.c(a,k);b.h&&S(a,h,d,g)}catch(sa){throw Error(sa.message+" at output index "+f);}}function L(a,b,c,d,g,f){return{container:f.container,chunkSize:36+g,format:"WAVE",bitDepth:a,fmt:{chunkId:"fmt ",chunkSize:16,audioFormat:W[a]||65534,numChannels:b,sampleRate:c,byteRate:b*d*c,blockAlign:b*d,bitsPerSample:parseInt(a,10),cbSize:0,validBitsPerSample:0,dwChannelMask:0,subformat:[]}}}function fa(a){if(!W[a.bitDepth]){if(8<parseInt(a.bitDepth,10)&&54>parseInt(a.bitDepth,
10))return!0;throw Error("Invalid bit depth.");}return!0}function ha(a){var b=a.fmt.numChannels*a.fmt.bitsPerSample/8;if(1>a.fmt.numChannels||65535<b)throw Error("Invalid number of channels.");return!0}function ia(a){var b=a.fmt.bitsPerSample/8*a.fmt.numChannels*a.fmt.sampleRate;if(1>a.fmt.sampleRate||4294967295<b)throw Error("Invalid sample rate.");return!0}function Ka(a,b,c){var d=[];16<a.fmt.chunkSize&&(d=d.concat(k(a.fmt.cbSize,c)));18<a.fmt.chunkSize&&(d=d.concat(k(a.fmt.validBitsPerSample,c)));
20<a.fmt.chunkSize&&(d=d.concat(k(a.fmt.dwChannelMask,b)));24<a.fmt.chunkSize&&(d=d.concat(k(a.fmt.subformat[0],b),k(a.fmt.subformat[1],b),k(a.fmt.subformat[2],b),k(a.fmt.subformat[3],b)));return d}function La(a,b,c,d){return[].concat(q(a.chunkId),k(a.value.length+20,c),k(a.dwName,c),k(a.dwSampleLength,c),k(a.dwPurposeID,c),k(a.dwCountry,d),k(a.dwLanguage,d),k(a.dwDialect,d),k(a.dwCodePage,d),y.g(a.value,a.value.length))}function w(a,b,c){c=void 0===c?!1:c;for(var d=[],g=0;g<a.length;g++)if(a[g].chunkId==
b)if(c)d.push(a[g]);else return a[g];return"LIST"==b?d.length?d:null:null}function ja(a){for(var b=[],c=D;c<=a.length-8;)b.push(Ma(a,c)),c+=8+b[b.length-1].chunkSize,c=c%2?c+1:c;return b}function Ma(a,b){var c={chunkId:ka(a,b),chunkSize:la(a,b)};"LIST"==c.chunkId?(c.format=J(a,b+8,b+12),D+=4,c.subChunks=ja(a)):(D=b+8+(c.chunkSize%2?c.chunkSize+1:c.chunkSize),c.chunkData={start:b+8,end:D});return c}function ka(a,b){D+=4;return J(a,b,b+4)}function la(a,b){D+=4;return U(a,ma,b+4)}for(var aa=new Float32Array(1),
ea=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],R=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767],C=0,F=0,A=0,B=0,G=7,Da=[1,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,
5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],Ga=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],Ia=[0,132,396,924,1980,4092,8316,16764],H=new Uint8Array(256),M=0;64>M;M++)H["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(M)]=M;E.prototype.g=function(a,b,c){Math.abs(b)>this.o-2*this.s&&(b=0>b?-Infinity:Infinity);var d=0>((b=+b)||1/b)?1:0>b?1:0;b=Math.abs(b);
var g=Math.min(Math.floor(Math.log(b)/Math.LN2),1023),f=this.l(b/Math.pow(2,g)*Math.pow(2,this.c));b!==b?(f=Math.pow(2,this.c-1),g=(1<<this.b)-1):0!==b&&(b>=Math.pow(2,1-this.a)?(2<=f/Math.pow(2,this.c)&&(g+=1,f=1),g>this.a?(g=(1<<this.b)-1,f=0):(g+=this.a,f=this.l(f)-Math.pow(2,this.c))):(f=this.l(b/Math.pow(2,1-this.a-this.c)),g=0));return this.w(a,c,d,g,f)};E.prototype.i=function(a,b){for(var c=(1<<this.b)-1,d="",g=this.j-1;0<=g;g--){var f=a[g+b].toString(2);d+="00000000".substring(f.length)+f}a=
"1"==d.charAt(0)?-1:1;d=d.substring(1);b=parseInt(d.substring(0,this.b),2);d=d.substring(this.b);if(b==c)return 0!==parseInt(d,2)?NaN:Infinity*a;0===b?(b+=1,c=parseInt(d,2)):c=parseInt("1"+d,2);return a*c*this.u*Math.pow(2,b-this.a)};E.prototype.w=function(a,b,c,d,g){var f=[];f.push(c);for(c=this.b;0<c;--c)f[c]=d%2?1:0,d=Math.floor(d/2);d=f.length;for(c=this.c;0<c;--c)f[d+c]=g%2?1:0,g=Math.floor(g/2);g=f.join("");f=this.j+b-1;for(d=b;f>=b;)a[f]=parseInt(g.substring(0,8),2),g=g.substring(8),f--,d++;
return d};E.prototype.l=function(a){var b=Math.floor(a);a-=b;return.5>a?b:.5<a?b+1:b%2?b+1:b};u.prototype.g=function(a,b,c){c=void 0===c?0:c;if(b!==b)throw Error("NaN");this.a(b);a[c]=(0>b?b+Math.pow(2,this.f):b)&255;c++;for(var d=this.b,g=2;g<d;g++)a[c]=Math.floor(b/Math.pow(2,8*(g-1)))&255,c++;8<this.f&&(a[c]=Math.floor(b/Math.pow(2,8*(this.b-1)))&this.j,c++);return c};u.prototype.i=function(a,b){a=this.c(a,void 0===b?0:b);this.a(a);return a};u.prototype.c=function(a,b){for(var c=0,d=0;d<this.b;d++)c+=
a[b+d]*Math.pow(256,d);return c};u.prototype.a=function(a){if(a>this.max||a<this.min)throw Error("Overflow");};Y(p,u);p.prototype.g=function(a,b,c){return u.prototype.g.call(this,a,b,void 0===c?0:c)};p.prototype.i=function(a,b){a=u.prototype.c.call(this,a,void 0===b?0:b);a=this.l(a);this.a(a);return a};p.prototype.l=function(a){a>this.max&&(a-=2*this.max+2);return a};n.prototype.c=function(a,b){return this.a.i(a,void 0===b?0:b)};n.prototype.b=function(a,b,c){return this.a.g(a,b,void 0===c?0:c)};n.prototype.g=
function(a){return 16===a?new E(5,11):32===a?new E(8,23):new E(11,52)};var W={4:17,8:1,"8a":6,"8m":7,16:1,24:1,32:1,"32f":3,64:3};l.prototype.g=function(a,b){var c=void 0===c?!0:c;a=q(a);if(c)for(c=a.length;c<b;c++)a.push(0);return a};l.prototype.i=function(a,b){var c="";for(b=void 0===b?0:b;b<a.length;b++){this.b++;if(0===a[b])break;c+=J(a,b,b+1)}return c};l.prototype.c=function(a,b){a=J(a,this.b,this.b+b);this.b+=b;return a};l.prototype.a=function(a,b){var c=b.f/8;a=U(a,b,this.b);this.b+=c;return a};
var y=new l,ma={f:32},D=0,h=new l;Y(e,m);e.prototype.getSample=function(a){a*=this.dataType.f/8;if(a+this.dataType.f/8>this.data.samples.length)throw Error("Range error");return U(this.data.samples.slice(a,a+this.dataType.f/8),this.dataType)};e.prototype.setSample=function(a,b){a*=this.dataType.f/8;if(a+this.dataType.f/8>this.data.samples.length)throw Error("Range error");K([b],this.dataType,this.data.samples,void 0===a?0:a)};e.prototype.fromScratch=function(a,b,c,d,g){g=void 0===g?{}:g;g.container||
(g.container="RIFF");this.container=g.container;this.bitDepth=c;d=this.G(d);this.u();var f=this.dataType.f/8;this.data.samples=new Uint8Array(d.length*f);K(d,this.dataType,this.data.samples);d=this.data.samples.length;"4"==c?(a=L(c,a,b,f,d,g),a.chunkSize=40+d,a.fmt.chunkSize=20,a.fmt.byteRate=4055,a.fmt.blockAlign=256,a.fmt.bitsPerSample=4,a.fmt.cbSize=2,a.fmt.validBitsPerSample=505,a.fact={chunkId:"fact",chunkSize:4,dwSampleLength:2*d}):"8a"==c||"8m"==c?(a=L(c,a,b,f,d,g),a.chunkSize=40+d,a.fmt.chunkSize=
20,a.fmt.cbSize=2,a.fmt.validBitsPerSample=8,a.fact={chunkId:"fact",chunkSize:4,dwSampleLength:d}):-1==Object.keys(W).indexOf(c)||2<a?(b=L(c,a,b,f,d,g),b.chunkSize=60+d,b.fmt.chunkSize=40,b.fmt.bitsPerSample=(parseInt(c,10)-1|7)+1,b.fmt.cbSize=22,b.fmt.validBitsPerSample=parseInt(c,10),d=0,1===a?d=4:2===a?d=3:4===a?d=51:6===a?d=63:8===a&&(d=1599),b.fmt.dwChannelMask=d,b.fmt.subformat=[1,1048576,2852126848,1905997824],a=b):a=L(c,a,b,f,d,g);this.s();this.chunkSize=a.chunkSize;this.format=a.format;this.fmt=
a.fmt;a.fact&&(this.fact=a.fact);this.data.chunkId="data";this.data.chunkSize=this.data.samples.length;fa(this);ha(this);ia(this)};e.prototype.fromBuffer=function(a,b){b=void 0===b?!0:b;this.s();var c=b;b={f:32,h:!1};var d={f:16,h:!1};h.b=0;this.container=h.c(a,4);if(-1===["RIFF","RIFX","RF64"].indexOf(this.container))throw Error("Not a supported format.");d.h="RIFX"===this.container;b.h=d.h;this.chunkSize=h.a(a,b);this.format=h.c(a,4);if("WAVE"!=this.format)throw Error('Could not find the "WAVE" format identifier');
D=0;var g=ka(a,0);ma.h="RIFX"==g;D+=4;la(a,0);g=ja(a);var f=w(g,"ds64");if(f)h.b=f.chunkData.start,this.ds64.chunkId=f.chunkId,this.ds64.chunkSize=f.chunkSize,this.ds64.riffSizeHigh=h.a(a,b),this.ds64.riffSizeLow=h.a(a,b),this.ds64.dataSizeHigh=h.a(a,b),this.ds64.dataSizeLow=h.a(a,b),this.ds64.originationTime=h.a(a,b),this.ds64.sampleCountHigh=h.a(a,b),this.ds64.sampleCountLow=h.a(a,b);else if("RF64"==this.container)throw Error('Could not find the "ds64" chunk');if(f=w(g,"fmt "))h.b=f.chunkData.start,
this.fmt.chunkId=f.chunkId,this.fmt.chunkSize=f.chunkSize,this.fmt.audioFormat=h.a(a,d),this.fmt.numChannels=h.a(a,d),this.fmt.sampleRate=h.a(a,b),this.fmt.byteRate=h.a(a,b),this.fmt.blockAlign=h.a(a,d),this.fmt.bitsPerSample=h.a(a,d),16<this.fmt.chunkSize&&(this.fmt.cbSize=h.a(a,d),18<this.fmt.chunkSize&&(this.fmt.validBitsPerSample=h.a(a,d),20<this.fmt.chunkSize&&(this.fmt.dwChannelMask=h.a(a,b),this.fmt.subformat=[h.a(a,b),h.a(a,b),h.a(a,b),h.a(a,b)])));else throw Error('Could not find the "fmt " chunk');
if(f=w(g,"fact"))h.b=f.chunkData.start,this.fact.chunkId=f.chunkId,this.fact.chunkSize=f.chunkSize,this.fact.dwSampleLength=h.a(a,b);if(f=w(g,"bext"))h.b=f.chunkData.start,this.bext.chunkId=f.chunkId,this.bext.chunkSize=f.chunkSize,this.bext.description=h.c(a,256),this.bext.originator=h.c(a,32),this.bext.originatorReference=h.c(a,32),this.bext.originationDate=h.c(a,10),this.bext.originationTime=h.c(a,8),this.bext.timeReference=[h.a(a,b),h.a(a,b)],this.bext.version=h.a(a,d),this.bext.UMID=h.c(a,64),
this.bext.loudnessValue=h.a(a,d),this.bext.loudnessRange=h.a(a,d),this.bext.maxTruePeakLevel=h.a(a,d),this.bext.maxMomentaryLoudness=h.a(a,d),this.bext.maxShortTermLoudness=h.a(a,d),this.bext.reserved=h.c(a,180),this.bext.codingHistory=h.c(a,this.bext.chunkSize-602);if(f=w(g,"cue "))for(h.b=f.chunkData.start,this.cue.chunkId=f.chunkId,this.cue.chunkSize=f.chunkSize,this.cue.dwCuePoints=h.a(a,b),f=0;f<this.cue.dwCuePoints;f++)this.cue.points.push({dwName:h.a(a,b),dwPosition:h.a(a,b),fccChunk:h.c(a,
4),dwChunkStart:h.a(a,b),dwBlockStart:h.a(a,b),dwSampleOffset:h.a(a,b)});if(f=w(g,"smpl"))for(h.b=f.chunkData.start,this.smpl.chunkId=f.chunkId,this.smpl.chunkSize=f.chunkSize,this.smpl.dwManufacturer=h.a(a,b),this.smpl.dwProduct=h.a(a,b),this.smpl.dwSamplePeriod=h.a(a,b),this.smpl.dwMIDIUnityNote=h.a(a,b),this.smpl.dwMIDIPitchFraction=h.a(a,b),this.smpl.dwSMPTEFormat=h.a(a,b),this.smpl.dwSMPTEOffset=h.a(a,b),this.smpl.dwNumSampleLoops=h.a(a,b),this.smpl.dwSamplerData=h.a(a,b),f=0;f<this.smpl.dwNumSampleLoops;f++)this.smpl.loops.push({dwName:h.a(a,
b),dwType:h.a(a,b),dwStart:h.a(a,b),dwEnd:h.a(a,b),dwFraction:h.a(a,b),dwPlayCount:h.a(a,b)});if(f=w(g,"data"))this.data.chunkId="data",this.data.chunkSize=f.chunkSize,c&&(this.data.samples=a.slice(f.chunkData.start,f.chunkData.end));else throw Error('Could not find the "data" chunk');if(c=w(g,"junk"))this.junk={chunkId:c.chunkId,chunkSize:c.chunkSize,chunkData:[].slice.call(a.slice(c.chunkData.start,c.chunkData.end))};g=w(g,"LIST",!0);if(null!==g)for(c=0;c<g.length;c++){f=g[c];this.LIST.push({chunkId:f.chunkId,
chunkSize:f.chunkSize,format:f.format,subChunks:[]});for(var e=0;e<f.subChunks.length;e++){var k=f.subChunks[e],l=f.format,m=a,n=b,q=d;"adtl"==l?-1<["labl","note","ltxt"].indexOf(k.chunkId)&&(h.b=k.chunkData.start,l={chunkId:k.chunkId,chunkSize:k.chunkSize,dwName:h.a(m,n)},"ltxt"==k.chunkId&&(l.dwSampleLength=h.a(m,n),l.dwPurposeID=h.a(m,n),l.dwCountry=h.a(m,q),l.dwLanguage=h.a(m,q),l.dwDialect=h.a(m,q),l.dwCodePage=h.a(m,q)),l.value=h.i(m,h.b),this.LIST[this.LIST.length-1].subChunks.push(l)):"INFO"==
l&&(h.b=k.chunkData.start,this.LIST[this.LIST.length-1].subChunks.push({chunkId:k.chunkId,chunkSize:k.chunkSize,value:h.i(m,h.b)}))}}this.w();this.u()};e.prototype.toBuffer=function(){fa(this);ha(this);ia(this);var a={f:32,h:!1},b={f:16,h:!1};b.h="RIFX"===this.container;a.h=b.h;var c=[];c=this.junk.chunkId?c.concat(q(this.junk.chunkId),k(this.junk.chunkData.length,a),this.junk.chunkData):c;var d=[];this.ds64.chunkId&&(d=d.concat(q(this.ds64.chunkId),k(this.ds64.chunkSize,a),k(this.ds64.riffSizeHigh,
a),k(this.ds64.riffSizeLow,a),k(this.ds64.dataSizeHigh,a),k(this.ds64.dataSizeLow,a),k(this.ds64.originationTime,a),k(this.ds64.sampleCountHigh,a),k(this.ds64.sampleCountLow,a)));var g=[];for(f in this.bext)if(this.bext.hasOwnProperty(f)&&this.bext[f]&&"timeReference"!=f){this.bext.chunkId="bext";break}if(this.bext.timeReference[0]||this.bext.timeReference[1])this.bext.chunkId="bext";this.bext.chunkId&&(this.bext.chunkSize=602+this.bext.codingHistory.length,g=g.concat(q(this.bext.chunkId),k(602+this.bext.codingHistory.length,
a),y.g(this.bext.description,256),y.g(this.bext.originator,32),y.g(this.bext.originatorReference,32),y.g(this.bext.originationDate,10),y.g(this.bext.originationTime,8),k(this.bext.timeReference[0],a),k(this.bext.timeReference[1],a),k(this.bext.version,b),y.g(this.bext.UMID,64),k(this.bext.loudnessValue,b),k(this.bext.loudnessRange,b),k(this.bext.maxTruePeakLevel,b),k(this.bext.maxMomentaryLoudness,b),k(this.bext.maxShortTermLoudness,b),y.g(this.bext.reserved,180),y.g(this.bext.codingHistory,this.bext.codingHistory.length)));
var f=g;g=[];if(this.fmt.chunkId)g=g.concat(q(this.fmt.chunkId),k(this.fmt.chunkSize,a),k(this.fmt.audioFormat,b),k(this.fmt.numChannels,b),k(this.fmt.sampleRate,a),k(this.fmt.byteRate,a),k(this.fmt.blockAlign,b),k(this.fmt.bitsPerSample,b),Ka(this,a,b));else throw Error('Could not find the "fmt " chunk');var e=[];this.fact.chunkId&&(e=e.concat(q(this.fact.chunkId),k(this.fact.chunkSize,a),k(this.fact.dwSampleLength,a)));var h=q(this.data.chunkId),l=k(this.data.samples.length,a),m=this.data.samples;
var n=[];if(this.cue.chunkId){var p=[];for(var r=0;r<this.cue.dwCuePoints;r++)p=p.concat(k(this.cue.points[r].dwName,a),k(this.cue.points[r].dwPosition,a),q(this.cue.points[r].fccChunk),k(this.cue.points[r].dwChunkStart,a),k(this.cue.points[r].dwBlockStart,a),k(this.cue.points[r].dwSampleOffset,a));n=n.concat(q(this.cue.chunkId),k(p.length+4,a),k(this.cue.dwCuePoints,a),p)}p=[];if(this.smpl.chunkId){r=[];for(var v=0;v<this.smpl.dwNumSampleLoops;v++)r=r.concat(k(this.smpl.loops[v].dwName,a),k(this.smpl.loops[v].dwType,
a),k(this.smpl.loops[v].dwStart,a),k(this.smpl.loops[v].dwEnd,a),k(this.smpl.loops[v].dwFraction,a),k(this.smpl.loops[v].dwPlayCount,a));p=p.concat(q(this.smpl.chunkId),k(r.length+36,a),k(this.smpl.dwManufacturer,a),k(this.smpl.dwProduct,a),k(this.smpl.dwSamplePeriod,a),k(this.smpl.dwMIDIUnityNote,a),k(this.smpl.dwMIDIPitchFraction,a),k(this.smpl.dwSMPTEFormat,a),k(this.smpl.dwSMPTEOffset,a),k(this.smpl.dwNumSampleLoops,a),k(this.smpl.dwSamplerData,a),r)}r=[];for(v=0;v<this.LIST.length;v++){var t=
this.LIST[v].subChunks;for(var u=this.LIST[v].format,w=a,A=b,z=[],x=0;x<t.length;x++)"INFO"==u?(z=z.concat(q(t[x].chunkId),k(t[x].value.length+1,w),y.g(t[x].value,t[x].value.length)),z.push(0)):"adtl"==u&&(-1<["labl","note"].indexOf(t[x].chunkId)?(z=z.concat(q(t[x].chunkId),k(t[x].value.length+4+1,w),k(t[x].dwName,w),y.g(t[x].value,t[x].value.length)),z.push(0)):"ltxt"==t[x].chunkId&&(z=z.concat(La(t[x],this,w,A)))),z.length%2&&z.push(0);t=z;r=r.concat(q(this.LIST[v].chunkId),k(t.length+4,a),q(this.LIST[v].format),
t)}b=[c,d,f,g,e,h,l,m,n,p,r];for(d=c=0;d<b.length;d++)c+=b[d].length;d=new Uint8Array(c+12);f=T(this.container,d,0);f=K([c+4],a,d,void 0===f?0:f);f=T(this.format,d,void 0===f?0:f);for(a=0;a<b.length;a++)d.set(b[a],f),f+=b[a].length;return d};e.prototype.fromBase64=function(a){this.fromBuffer(new Uint8Array(ra(a)))};e.prototype.toBase64=function(){var a=this.toBuffer();a=new Uint8Array(a,0,a.length);for(var b=a.length,c="",d=0;d<b;d+=3)c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a[d]>>
2],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(a[d]&3)<<4|a[d+1]>>4],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(a[d+1]&15)<<2|a[d+2]>>6],c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a[d+2]&63];2===b%3?c=c.substring(0,c.length-1)+"\x3d":1===b%3&&(c=c.substring(0,c.length-2)+"\x3d\x3d");return c};e.prototype.toDataURI=function(){return"data:audio/wav;base64,"+this.toBase64()};e.prototype.fromDataURI=function(a){this.fromBase64(a.replace("data:audio/wav;base64,",
""))};e.prototype.toRIFF=function(){this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,this.bitDepth,V(this.data.samples,this.dataType))};e.prototype.toRIFX=function(){this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,this.bitDepth,V(this.data.samples,this.dataType),{container:"RIFX"})};e.prototype.toBitDepth=function(a,b){var c=a,d=this.bitDepth;void 0===b||b||("32f"!=a&&(c=this.dataType.f.toString()),d=this.dataType.f);this.o();var e=this.data.samples.length/(this.dataType.f/8);b=
new Float64Array(e+1);e=new Float64Array(e+1);I(this.data.samples,this.dataType,b);"32f"!=d&&"64"!=d||this.J(b);var f=d;d=c;ba(f);ba(d);var h=xa(f,d),k={F:Math.pow(2,parseInt(f,10))/2,C:Math.pow(2,parseInt(d,10))/2,D:Math.pow(2,parseInt(f,10))/2-1,B:Math.pow(2,parseInt(d,10))/2-1};c=b.length;if("8"==f)for(f=0;f<c;f++)e[f]=b[f]-=128;for(f=0;f<c;f++)e[f]=h(b[f],k);if("8"==d)for(b=0;b<c;b++)e[b]=e[b]+=128;this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,a,e,{container:this.a()})};e.prototype.toIMAADPCM=
function(){if(8E3!==this.fmt.sampleRate)throw Error("Only 8000 Hz files can be compressed as IMA-ADPCM.");if(1!==this.fmt.numChannels)throw Error("Only mono files can be compressed as IMA-ADPCM.");this.c();var a=new Int16Array(this.data.samples.length/2);I(this.data.samples,this.dataType,a);this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"4",ya(a),{container:this.a()})};e.prototype.fromIMAADPCM=function(a){a=void 0===a?"16":a;this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"16",
Aa(this.data.samples,this.fmt.blockAlign),{container:this.a()});"16"!=a&&this.toBitDepth(a)};e.prototype.toALaw=function(){this.c();var a=new Int16Array(this.data.samples.length/2);I(this.data.samples,this.dataType,a);this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"8a",Ca(a),{container:this.a()})};e.prototype.fromALaw=function(a){a=void 0===a?"16":a;this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"16",Ea(this.data.samples),{container:this.a()});"16"!=a&&this.toBitDepth(a)};e.prototype.toMuLaw=
function(){this.c();var a=new Int16Array(this.data.samples.length/2);I(this.data.samples,this.dataType,a);this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"8m",Fa(a),{container:this.a()})};e.prototype.fromMuLaw=function(a){a=void 0===a?"16":a;this.fromScratch(this.fmt.numChannels,this.fmt.sampleRate,"16",Ha(this.data.samples),{container:this.a()});"16"!=a&&this.toBitDepth(a)};e.prototype.setTag=function(a,b){a=this.L(a);var c=this.l(a);null!==c.m?(this.LIST[c.LIST].subChunks[c.m].chunkSize=
b.length+1,this.LIST[c.LIST].subChunks[c.m].value=b):null!==c.LIST?this.LIST[c.LIST].subChunks.push({chunkId:a,chunkSize:b.length+1,value:b}):(this.LIST.push({chunkId:"LIST",chunkSize:b.length+9,format:"INFO",subChunks:[]}),this.LIST[this.LIST.length-1].subChunks.push({chunkId:a,chunkSize:b.length+1,value:b}))};e.prototype.getTag=function(a){a=this.l(a);return null!==a.m?this.LIST[a.LIST].subChunks[a.m].value:null};e.prototype.listTags=function(){var a=this.M(),b={};if(null!==a)for(var c=0,d=this.LIST[a].subChunks.length;c<
d;c++)b[this.LIST[a].subChunks[c].chunkId]=this.LIST[a].subChunks[c].value;return b};e.prototype.deleteTag=function(a){a=this.l(a);return null!==a.m?(this.LIST[a.LIST].subChunks.splice(a.m,1),!0):!1};e.prototype.setCuePoint=function(a,b){b=void 0===b?"":b;this.cue.chunkId="cue ";a=a*this.fmt.sampleRate/1E3;var c=this.j();this.g();var d=this.cue.points.length;this.cue.points=[];var e=!1;if(0===d)this.b(a,1,b);else{for(var f=0;f<d;f++)c[f].dwPosition>a&&!e?(this.b(a,f+1,b),this.b(c[f].dwPosition,f+
2,c[f].label),e=!0):this.b(c[f].dwPosition,f+1,c[f].label);e||this.b(a,this.cue.points.length+1,b)}this.cue.dwCuePoints=this.cue.points.length};e.prototype.deleteCuePoint=function(a){this.cue.chunkId="cue ";var b=this.j();this.g();var c=this.cue.points.length;this.cue.points=[];for(var d=0;d<c;d++)d+1!==a&&this.b(b[d].dwPosition,d+1,b[d].label);this.cue.dwCuePoints=this.cue.points.length;this.cue.dwCuePoints?this.cue.chunkId="cue ":(this.cue.chunkId="",this.g())};e.prototype.listCuePoints=function(){for(var a=
this.j(),b=0,c=a.length;b<c;b++)a[b].milliseconds=a[b].dwPosition/this.fmt.sampleRate*1E3;return a};e.prototype.updateLabel=function(a,b){var c=this.i();if(null!==c)for(var d=0,e=this.LIST[c].subChunks.length;d<e;d++)this.LIST[c].subChunks[d].dwName==a&&(this.LIST[c].subChunks[d].value=b)};e.prototype.w=function(){3===this.fmt.audioFormat&&32===this.fmt.bitsPerSample?this.bitDepth="32f":6===this.fmt.audioFormat?this.bitDepth="8a":7===this.fmt.audioFormat?this.bitDepth="8m":this.bitDepth=this.fmt.bitsPerSample.toString()};
e.prototype.b=function(a,b,c){this.cue.points.push({dwName:b,dwPosition:a,fccChunk:"data",dwChunkStart:0,dwBlockStart:0,dwSampleOffset:a});this.I(b,c)};e.prototype.j=function(){for(var a=[],b=0,c=this.cue.points.length;b<c;b++)a.push({dwPosition:this.cue.points[b].dwPosition,label:this.N(this.cue.points[b].dwName)});return a};e.prototype.N=function(a){var b=this.i();if(null!==b)for(var c=0,d=this.LIST[b].subChunks.length;c<d;c++)if(this.LIST[b].subChunks[c].dwName==a)return this.LIST[b].subChunks[c].value;
return""};e.prototype.g=function(){for(var a=0,b=this.LIST.length;a<b;a++)"adtl"==this.LIST[a].format&&this.LIST.splice(a)};e.prototype.I=function(a,b){var c=this.i();null===c&&(this.LIST.push({chunkId:"LIST",chunkSize:4,format:"adtl",subChunks:[]}),c=this.LIST.length-1);this.H(null===c?0:c,a,b)};e.prototype.H=function(a,b,c){this.LIST[a].subChunks.push({chunkId:"labl",chunkSize:c.length,dwName:b,value:c});this.LIST[a].chunkSize+=c.length+13};e.prototype.i=function(){for(var a=0,b=this.LIST.length;a<
b;a++)if("adtl"==this.LIST[a].format)return a;return null};e.prototype.M=function(){for(var a=null,b=0,c=this.LIST.length;b<c;b++)if("INFO"===this.LIST[b].format){a=b;break}return a};e.prototype.l=function(a){for(var b={LIST:null,m:null},c=0,d=this.LIST.length;c<d;c++)if("INFO"==this.LIST[c].format){b.LIST=c;d=0;for(var e=this.LIST[c].subChunks.length;d<e;d++)if(this.LIST[c].subChunks[d].chunkId==a){b.m=d;break}break}return b};e.prototype.L=function(a){if(a.constructor!==String)throw Error("Invalid tag name.");
if(4>a.length)for(var b=0,c=4-a.length;b<c;b++)a+=" ";return a};e.prototype.s=function(){this.fmt.cbSize=0;this.fmt.validBitsPerSample=0;this.fact.chunkId="";this.ds64.chunkId=""};e.prototype.c=function(){this.o();"16"!=this.bitDepth&&this.toBitDepth("16")};e.prototype.o=function(){"8a"==this.bitDepth?this.fromALaw():"8m"==this.bitDepth?this.fromMuLaw():"4"==this.bitDepth&&this.fromIMAADPCM()};e.prototype.G=function(a){if(0<a.length&&a[0].constructor===Array){for(var b=[],c=0,d=a[0].length;c<d;c++)for(var e=
0,f=a.length;e<f;e++)b.push(a[e][c]);a=b}return a};e.prototype.u=function(){this.dataType={f:(parseInt(this.bitDepth,10)-1|7)+1,v:"32f"==this.bitDepth||"64"==this.bitDepth,A:"8"!=this.bitDepth,h:"RIFX"==this.container};-1<["4","8a","8m"].indexOf(this.bitDepth)&&(this.dataType.f=8,this.dataType.A=!1)};e.prototype.a=function(){return"RF64"==this.container?"RIFF":this.container};e.prototype.J=function(a){for(var b=0,c=a.length;b<c;b++)1<a[b]?a[b]=1:-1>a[b]&&(a[b]=-1)};return e}();window.WaveFile=Na;
