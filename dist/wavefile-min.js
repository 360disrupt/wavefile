/*
 endianness: Swap byte endianness in a array of bytes.
 Copyright (c) 2017 Rafael da Silva Rocha.
 https://github.com/rochars/endianness
 to-half: int bits of half-precision floating point values
 Based on:
 https://mail.mozilla.org/pipermail/es-discuss/2017-April/047994.html
 https://github.com/rochars/byte-data
 Wavefile
 Handle wave files with 8, 16, 24, 32 PCM, 32 IEEE & 64-bit data.
 Copyright (c) 2017 Rafael da Silva Rocha. MIT License.
 https://github.com/rochars/wavefile

 byte-data
 Readable data to and from bytes.
 Copyright (c) 2017 Rafael da Silva Rocha.
 https://github.com/rochars/byte-data
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var k=function(){};k.prototype=a;return new k};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},k={};try{return k.__proto__=a,k.a}catch(h){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,k){a.__proto__=k;if(a.__proto__!==k)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,k){a.prototype=$jscomp.objectCreate(k.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var h=$jscomp.setPrototypeOf;h(a,k)}else for(h in k)if("prototype"!=h)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(k,h);e&&Object.defineProperty(a,h,e)}else a[h]=k[h];a.superClass_=k.prototype};
(function(a){function k(e){if(h[e])return h[e].exports;var l=h[e]={i:e,l:!1,exports:{}};a[e].call(l.exports,l,l.exports,k);l.l=!0;return l.exports}var h={};k.m=a;k.c=h;k.d=function(a,l,f){k.o(a,l)||Object.defineProperty(a,l,{configurable:!1,enumerable:!0,get:f})};k.n=function(a){var l=a&&a.__esModule?function(){return a["default"]}:function(){return a};k.d(l,"a",l);return l};k.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)};k.p="";return k(k.s=5)})([function(a,k){function h(a,f){var c=
a.length+1;2==f?c=8:16==f&&(c=2);return e(a,c)}function e(a,f){for(;a.length<f;)a="0"+a;return a}a.exports.fixByteArraySize=function(a,f){var c=0,b=a.length%f;if(b)for(b=-1*(b-f);c<b;)a.push(0),c++};a.exports.padding=function(a,f,c){a[c]=h(a[c],f)};a.exports.paddingNibble=function(a,f,c){2==f&&4>a[c].length&&(a[c]=Array(5-a[c].length).join("0")+a[c])};a.exports.paddingCrumb=function(a,f,c){(2==f||16==f)&&2>a[c].length&&(a[c]="0"+a[c])};a.exports.bytePadding=h;a.exports.lPadZeros=e},function(a,k){function h(a){e[0]=
a;return l[0]}k=new Int8Array(4);var e=new Int32Array(k.buffer,0,1),l=new Float32Array(k.buffer,0,1);a.exports=h;a.exports.pack=h;a.exports.unpack=function(a){l[0]=a;return e[0]}},function(a,k){a.exports.endianness=function(a,e){for(var l=a.length,f=0;f<l;){for(var c,b=a,g=f,d=0,h=e-1,k=parseInt(e/2,10);d<k;)c=b[g+d],b[g+d]=b[g+h],b[g+h]=c,d++,h--;f+=e}return a}},function(a,k,h){function e(c,a){a=void 0===a?!1:a;for(var d="",b=0,g=c.length;b<g;){var f=l.lPadZeros(c[b].toString(2),8);d=a?d+f:f+d;b++}return d}
var l=h(0),f=new Float32Array(1),c=new Int32Array(f.buffer);a.exports.getBinary=e;a.exports.decodeFloat16=function(c){c=parseInt(e(c,!0),2);var a=(c&31744)>>10,d=c&1023;return(a?Math.pow(2,a-15)*(1+d/1024):d/1024*.00006103515625)*(c>>15?-1:1)};a.exports.decodeFloat64=function(c){if("0,0,0,0,0,0,0,0"==c.toString())return 0;c=e(c);for(var a="1"+c.substr(12,52),d=1,b=0,f=0;f<a.length;)b+=d*parseInt(a.charAt(f),10),d/=2,f++;return("1"==c.charAt(0)?-1:1)*b*Math.pow(2,parseInt(c.substr(1,11),2)-1023)};
a.exports.toFloat64=function(c){if(0==c)return[0,0];var a=0;0>=c&&(a=2147483648,c=-c);var d=Math.floor(Math.log(c)/Math.log(2)),b=Math.floor(c/Math.pow(2,d)*Math.pow(2,52));c=b&4294967295;b/=Math.pow(2,32);return[a|d+1023<<20|b&1048575,c]};a.exports.toHalf=function(a){f[0]=a;var b=c[0];a=b>>16&32768;var d=b>>12&2047;b=b>>23&255;return 103>b?a:(a|b-112<<10|d>>1)+(d&1)}},function(a,k){a.exports.bitDepthOffsets={1:1,2:1,4:1,8:1,16:2,24:3,32:4,40:5,48:6,64:8};a.exports.maxBitDepth={2:4,4:16,8:256,16:65536,
24:16777216,32:4294967296,40:1099511627776,48:281474976710656}},function(a,k,h){var e=h(6),l=h(12);a=function(a,c,b){c=void 0===c?!1:c;b=void 0===b?!1:b;var f=l.WaveFileHeader.call(this)||this;f.isFromScratch_=!1;f.enforceFact=c;f.enforceBext=b;f.WaveErrors={format:"Not a supported format.",wave:"Could not find the 'WAVE' chunk","fmt ":"Could not find the 'fmt ' chunk",data:"Could not find the 'data' chunk",fact:"Could not find the 'fact' chunk",bext:"Could not find the 'bext' chunk",bitDepth:"Invalid bit depth.",
numChannels:"Invalid number of channels.",sampleRate:"Invalid sample rate."};f.samples_=[];f.bytes_=[];a&&f.fromBytes(a);return f};$jscomp.inherits(a,l.WaveFileHeader);a.prototype.fromScratch=function(a,c,b,g){this.isFromScratch_=!0;var d=parseInt(b,10)/8;this.chunkSize=36+g.length*d;this.subChunk1Size=16;this.byteRate=a*d*c;this.blockAlign=a*d;this.chunkId="RIFF";this.format="WAVE";this.subChunk1Id="fmt ";this.audioFormat=this.headerFormats_[b];this.numChannels=a;this.sampleRate=c;this.bitsPerSample=
parseInt(b,10);this.subChunk2Id="data";this.subChunk2Size=g.length*d;this.samples_=g;this.bitDepth_=b};a.prototype.fromBytes=function(a){this.isFromScratch_=!1;this.readRIFFChunk_(a);this.readWAVEChunk_(a);this.readFmtChunk_(a);this.readFactChunk_(a);this.readBextChunk_(a);this.readDataChunk_(a)};a.prototype.toBytes=function(){this.checkWriteInput_(this.numChannels,this.sampleRate,this.bitDepth_);this.samplesToBytes_();return new Uint8Array(this.createWaveFile_())};a.prototype.interleave=function(){var a=
[],c,b,g=this.samples_[0].length;for(c=0;c<g;c++)for(b=0;b<this.samples_.length;b++)a.push(this.samples_[b][c]);this.samples_=a};a.prototype.deInterleave=function(){var a=[],c;for(c=0;c<this.numChannels;c++)a[c]=[];c=0;for(var b;c<this.samples_.length;){for(b=0;b<this.numChannels;b++)a[b].push(this.samples_[c+b]);c+=b}this.samples_=a};a.prototype.readRIFFChunk_=function(a){this.chunkId=e.fromBytes(a.slice(0,4),8,{"char":!0});if("RIFF"!=this.chunkId)throw Error(this.WaveErrors.format);this.chunkSize=
e.fromBytes(a.slice(4,8),32)[0]};a.prototype.readWAVEChunk_=function(a){if(-1===e.findString(a,"WAVE"))throw Error(this.WaveErrors.wave);this.format="WAVE"};a.prototype.readFmtChunk_=function(a){var c=e.findString(a,"fmt ");if(-1===c)throw Error(this.WaveErrors["fmt "]);this.subChunk1Id="fmt ";this.subChunk1Size=e.fromBytes(a.slice(c+4,c+8),32)[0];this.audioFormat=e.fromBytes(a.slice(c+8,c+10),16)[0];this.numChannels=e.fromBytes(a.slice(c+10,c+12),16)[0];this.sampleRate=e.fromBytes(a.slice(c+12,c+
16),32)[0];this.byteRate=e.fromBytes(a.slice(c+16,c+20),32)[0];this.blockAlign=e.fromBytes(a.slice(c+20,c+22),16)[0];this.bitsPerSample=e.fromBytes(a.slice(c+22,c+24),16)[0];this.bitDepth_=3==this.audioFormat&&32==this.bitsPerSample?"32f":this.bitsPerSample.toString()};a.prototype.readFactChunk_=function(a){a=e.findString(a,"fact");if(-1===a&&this.enforceFact)throw Error(this.WaveErrors.fact);-1<a&&(this.factChunkId="fact")};a.prototype.readBextChunk_=function(a){a=e.findString(a,"bext");if(-1===
a&&this.enforceBext)throw Error(this.WaveErrors.bext);-1<a&&(this.bextChunkId="bext")};a.prototype.readDataChunk_=function(a){var c=e.findString(a,"data");if(-1===c)throw Error(this.WaveErrors.data);this.subChunk2Id="data";this.subChunk2Size=e.fromBytes(a.slice(c+4,c+8),32)[0];this.samplesFromBytes_(a,c)};a.prototype.samplesFromBytes_=function(a,c){var b={signed:8==this.bitsPerSample?!1:!0};32==this.bitsPerSample&&3==this.audioFormat&&(b.float=!0);a=a.slice(c+8,c+8+this.subChunk2Size);this.samples_=
4==this.bitsPerSample?e.fromBytes(a,8,b):e.fromBytes(a,this.bitsPerSample,b)};a.prototype.checkWriteInput_=function(){if(!this.headerFormats_[this.bitDepth_])throw Error(this.WaveErrors.bitDepth);this.validateNumChannels_();this.validateSampleRate_()};a.prototype.validateNumChannels_=function(){var a=this.numChannels*this.bitsPerSample/8;if(1>this.numChannels||65535<a)throw Error(this.WaveErrors.numChannels);return!0};a.prototype.validateSampleRate_=function(){var a=this.bitsPerSample/8*this.numChannels*
this.sampleRate;if(1>this.sampleRate||4294967295<a)throw Error(this.WaveErrors.sampleRate);return!0};a.prototype.samplesToBytes_=function(){var a={};32==this.bitsPerSample&&3==this.audioFormat&&(a.float=!0);this.bytes_=e.toBytes(this.samples_,4==this.bitsPerSample?8:this.bitsPerSample,a);this.bytes_.length%2&&this.bytes_.push(0)};a.prototype.createWaveFile_=function(){var a=[];this.factChunkId&&(a=e.toBytes(this.factChunkId,8,{"char":!0}));return e.toBytes(this.chunkId,8,{"char":!0}).concat(e.toBytes([this.chunkSize],
32),e.toBytes(this.format,8,{"char":!0}),e.toBytes(this.subChunk1Id,8,{"char":!0}),e.toBytes([this.subChunk1Size],32),e.toBytes([this.audioFormat],16),e.toBytes([this.numChannels],16),e.toBytes([this.sampleRate],32),e.toBytes([this.byteRate],32),e.toBytes([this.blockAlign],16),e.toBytes([this.bitsPerSample],16),a,e.toBytes(this.subChunk2Id,8,{"char":!0}),e.toBytes([this.subChunk2Size],32),this.bytes_)};window.WaveFile=a},function(a,k,h){k=h(7);var e=h(9);h=h(11);a.exports.findString=function(a,f){for(var c,
b=0;b<a.length;b++)if(c=e.fromBytes(a.slice(b,b+f.length),8,{"char":!0}),c==f)return b;return-1};a.exports.toBytes=k.toBytes;a.exports.fromBytes=e.fromBytes;a.exports.packBooleans=h.packBooleans;a.exports.unpackBooleans=h.unpackBooleans;a.exports.packCrumbs=h.packCrumbs;a.exports.unpackCrumbs=h.unpackCrumbs;a.exports.packNibbles=h.packNibbles;a.exports.unpackNibbles=h.unpackNibbles},function(a,k,h){function e(a,c,b){4==c?l(a,b,f.paddingNibble):2==c?l(a,b,f.paddingCrumb):1==c?l(a,b,function(){}):l(a,
b)}function l(a,c,b){b=void 0===b?f.padding:b;if(10!=c)for(var d=0,g=a.length;d<g;)a[d]=a[d].toString(c),b(a,c,d),d++}h(1);var f=h(0),c=h(2),b=h(8),g=h(4);a.exports.toBytes=function(a,f,l){l=void 0===l?{}:l;var d=10;"base"in l&&(d=l.base);var h=l.char?b.writeString:b["write"+f+"Bit"+(l.float?"Float":"")];for(var k=0,m=0,p=a.length,n=[];k<p;)m=h(n,a,k,m),k++;a=n;l.be&&c.endianness(a,g.bitDepthOffsets[f]);e(a,f,d);l.buffer&&(a=new Uint8Array(a));return a}},function(a,k,h){function e(a,b,g,d){a[d++]=
b[g]&255;a[d++]=b[g]>>>8&255;a[d++]=b[g]>>>16&255;a[d++]=b[g]>>>24&255;return d}var l=h(3),f=h(1);a.exports.write64Bit=function(a,b,g,d){b=l.toFloat64(b[g]);d=e(a,b,1,d);return e(a,b,0,d)};a.exports.write48Bit=function(a,b,g,d){a[d++]=b[g]&255;a[d++]=b[g]>>8&255;a[d++]=b[g]>>16&255;a[d++]=b[g]>>24&255;a[d++]=b[g]/4294967296&255;a[d++]=b[g]/1099511627776&255;return d};a.exports.write40Bit=function(a,b,g,d){a[d++]=b[g]&255;a[d++]=b[g]>>8&255;a[d++]=b[g]>>16&255;a[d++]=b[g]>>24&255;a[d++]=b[g]/4294967296&
255;return d};a.exports.write32BitFloat=function(a,b,g,d){b=f.unpack(b[g]);a[d++]=b&255;a[d++]=b>>>8&255;a[d++]=b>>>16&255;a[d++]=b>>>24&255;return d};a.exports.write32Bit=e;a.exports.write24Bit=function(a,b,g,d){a[d++]=b[g]&255;a[d++]=b[g]>>>8&255;a[d++]=b[g]>>>16&255;return d};a.exports.write16Bit=function(a,b,g,d){a[d++]=b[g]&255;a[d++]=b[g]>>>8&255;return d};a.exports.write16BitFloat=function(a,b,g,d){b=l.toHalf(b[g]);a[d++]=b>>>8&255;a[d++]=b&255;return d};a.exports.write8Bit=function(a,b,g,
d){a[d++]=b[g]&255;return d};a.exports.write4Bit=function(a,b,g,d){a[d++]=b[g]&15;return d};a.exports.write2Bit=function(a,b,g,d){a[d++]=0>b[g]?b[g]+4:b[g];return d};a.exports.write1Bit=function(a,b,g,d){a[d++]=b[g]?1:0;return d};a.exports.writeString=function(a,b,g,d){a[d++]=b.charCodeAt(g);return d}},function(a,k,h){function e(a,d,c,f){var g=[],e=0,h=0,k=b.bitDepthOffsets[d],m=a.length-(k-1);d=b.maxBitDepth[d];for(c=c?l:function(a,d){return a};e<m;)g[h]=c(f(a,e),d),e+=k,h++;return g}function l(a,
d){a>parseInt(d/2,10)-1&&(a-=d);return a}var f=h(2),c=h(10),b=h(4);a.exports.fromBytes=function(a,d,b){b=void 0===b?{}:b;var g=10;"base"in b&&(g=b.base);b.be&&f.endianness(a,d/8);if(10!=g)for(var l=0,h=a.length;l<h;)a[l]=parseInt(a[l],g),l++;a=e(a,d,b.signed,b.char?c.readChar:c["read"+(2==d||4==d?8:d)+"Bit"+(b.float?"Float":"")]);b.char&&(a=a.join(""));return a}},function(a,k,h){function e(a,b,c){--c;for(var d="";0<=c;)d+=f.bytePadding(a[c+b].toString(2),2),c--;return parseInt(d,2)}function l(a,b){return(a[3+
b]<<24|a[2+b]<<16|a[1+b]<<8|a[b])>>>0}var f=h(0),c=h(3),b=h(1);a.exports.readChar=function(a,b){return String.fromCharCode(a[b])};a.exports.read1Bit=function(a,b){return parseInt(a[b],2)};a.exports.read8Bit=function(a,b){return a[b]};a.exports.read16Bit=function(a,b){return a[1+b]<<8|a[b]};a.exports.read16BitFloat=function(a,b){return c.decodeFloat16(a.slice(b,b+2))};a.exports.read24Bit=function(a,b){return a[2+b]<<16|a[1+b]<<8|a[b]};a.exports.read32Bit=l;a.exports.read32BitFloat=function(a,c){return b.pack(l(a,
c))};a.exports.read40Bit=function(a,b){return e(a,b,5)};a.exports.read48Bit=function(a,b){return e(a,b,6)};a.exports.read64Bit=function(a,b){return c.decodeFloat64(a.slice(b,b+8))}},function(a,k,h){var e=h(0);a.exports.packBooleans=function(a){var f=[],c=0,b=0;e.fixByteArraySize(a,8);for(var g=a.length-7;c<g;)f[b++]=parseInt(a[c].toString(2)+a[c+1].toString(2)+a[c+2].toString(2)+a[c+3].toString(2)+a[c+4].toString(2)+a[c+5].toString(2)+a[c+6].toString(2)+a[c+7].toString(2),2),c+=8;return f};a.exports.unpackBooleans=
function(a){for(var f=[],c=0,b=0,g=a.length,d;c<g;)d=e.lPadZeros(a[c].toString(2),8),f[b++]=parseInt(d[0],2),f[b++]=parseInt(d[1],2),f[b++]=parseInt(d[2],2),f[b++]=parseInt(d[3],2),f[b++]=parseInt(d[4],2),f[b++]=parseInt(d[5],2),f[b++]=parseInt(d[6],2),f[b++]=parseInt(d[7],2),c++;return f};a.exports.packCrumbs=function(a){var f=[],c=0,b=0;e.fixByteArraySize(a,4);for(var g=a.length-3;c<g;)f[b++]=parseInt(e.lPadZeros(a[c].toString(2),2)+e.lPadZeros(a[c+1].toString(2),2)+e.lPadZeros(a[c+2].toString(2),
2)+e.lPadZeros(a[c+3].toString(2),2),2),c+=4;return f};a.exports.unpackCrumbs=function(a){var f=[],c=0,b=0,g=a.length;for(console.log(g);c<g;){var d=e.lPadZeros(a[c].toString(2),8);f[b++]=parseInt(d[0]+d[1],2);f[b++]=parseInt(d[2]+d[3],2);f[b++]=parseInt(d[4]+d[5],2);f[b++]=parseInt(d[6]+d[7],2);c++}return f};a.exports.packNibbles=function(a){var f=[],c=0,b=0,e=a.length;for(e%2&&a.push(0);c<e;)f[b++]=parseInt(a[c].toString(16)+a[c+1].toString(16),16),c+=2;return f};a.exports.unpackNibbles=function(a){for(var f=
[],c=0,b=0,e=a.length;c<e;)f[b++]=parseInt(a[c].toString(16)[0],16),f[b++]=parseInt(a[c].toString(16)[1],16),c++;return f}},function(a,k){a.exports.WaveFileHeader=function(){this.chunkId="";this.chunkSize=0;this.format=this.subChunk1Id="";this.cbSize=this.bitsPerSample=this.blockAlign=this.byteRate=this.sampleRate=this.numChannels=this.audioFormat=this.subChunk1Size=0;this.factChunkId="";this.factChunkSize=4;this.dwSampleLength=0;this.subChunk2Id="";this.subChunk2Size=0;this.bextChunkId="";this.headerFormats_=
{4:17,8:1,16:1,24:1,32:1,"32f":3,64:3}}}]);
