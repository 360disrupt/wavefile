/*
 byte-data
 Readable data to and from bytes.
 Copyright (c) 2017 Rafael da Silva Rocha.
 https://github.com/rochars/byte-data
 endianness: Swap byte endianness in a array of bytes.
 Copyright (c) 2017 Rafael da Silva Rocha.
 https://github.com/rochars/endianness
 to-half: int bits of half-precision floating point values
 Based on:
 https://mail.mozilla.org/pipermail/es-discuss/2017-April/047994.html
 https://github.com/rochars/byte-data
 bitdepth
 Change the bit depth of audio samples to and from 8, 16, 24, 32, 32 IEEE & 64-bit.
 Copyright (c) 2017 Rafael da Silva Rocha. MIT License.
 https://github.com/rochars/bitdepth

 wavefile
 Read & write wave files with 8, 16, 24, 32 PCM, 32 IEEE & 64-bit data.
 Copyright (c) 2017 Rafael da Silva Rocha. MIT License.
 https://github.com/rochars/wavefile

*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var f=function(){};f.prototype=a;return new f};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},f={};try{return f.__proto__=a,f.a}catch(h){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,f){a.__proto__=f;if(a.__proto__!==f)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,f){a.prototype=$jscomp.objectCreate(f.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var h=$jscomp.setPrototypeOf;h(a,f)}else for(h in f)if("prototype"!=h)if(Object.defineProperties){var g=Object.getOwnPropertyDescriptor(f,h);g&&Object.defineProperty(a,h,g)}else a[h]=f[h];a.superClass_=f.prototype};
(function(a){function f(g){if(h[g])return h[g].exports;var k=h[g]={i:g,l:!1,exports:{}};a[g].call(k.exports,k,k.exports,f);k.l=!0;return k.exports}var h={};f.m=a;f.c=h;f.d=function(a,k,c){f.o(a,k)||Object.defineProperty(a,k,{configurable:!1,enumerable:!0,get:c})};f.n=function(a){var k=a&&a.__esModule?function(){return a["default"]}:function(){return a};f.d(k,"a",k);return k};f.o=function(a,k){return Object.prototype.hasOwnProperty.call(a,k)};f.p="";return f(f.s=7)})([function(a,f){function h(a,c){var b=
a.length+1;2==c?b=8:16==c&&(b=2);return g(a,b)}function g(a,c){for(;a.length<c;)a="0"+a;return a}a.exports.fixByteArraySize=function(a,c){var b=0,e=a.length%c;if(e)for(e=-1*(e-c);b<e;)a.push(0),b++};a.exports.padding=function(a,c,b){a[b]=h(a[b],c)};a.exports.paddingNibble=function(a,c,b){2==c&&4>a[b].length&&(a[b]=Array(5-a[b].length).join("0")+a[b])};a.exports.paddingCrumb=function(a,c,b){(2==c||16==c)&&2>a[b].length&&(a[b]="0"+a[b])};a.exports.bytePadding=h;a.exports.lPadZeros=g},function(a,f){function h(c){g[0]=
c;return k[0]}f=new Int8Array(4);var g=new Int32Array(f.buffer,0,1),k=new Float32Array(f.buffer,0,1);a.exports=h;a.exports.pack=h;a.exports.unpack=function(c){k[0]=c;return g[0]}},function(a,f){a.exports.BitDepthOffsets={1:1,2:1,4:1,8:1,16:2,24:3,32:4,40:5,48:6,64:8};a.exports.BitDepthMaxValues={2:4,4:16,8:256,16:65536,24:16777216,32:4294967296,40:1099511627776,48:281474976710656}},function(a,f,h){f=h(9);var g=h(11),k=h(13);h=h(2);a.exports.findString=function(c,b){for(var e,l=0;l<c.length;l++)if(e=
g.fromBytes(c.slice(l,l+b.length),8,{"char":!0}),e==b)return l;return-1};a.exports.toBytes=f.toBytes;a.exports.fromBytes=g.fromBytes;a.exports.packBooleans=k.packBooleans;a.exports.unpackBooleans=k.unpackBooleans;a.exports.packCrumbs=k.packCrumbs;a.exports.unpackCrumbs=k.unpackCrumbs;a.exports.packNibbles=k.packNibbles;a.exports.unpackNibbles=k.unpackNibbles;a.exports.BitDepthOffsets=h.BitDepthOffsets;a.exports.BitDepthMaxValues=h.BitDepthMaxValues},function(a,f){a.exports.endianness=function(a,g){for(var k=
a.length,c=0;c<k;){for(var b,e=a,l=c,d=0,f=g-1,h=parseInt(g/2,10);d<h;)b=e[l+d],e[l+d]=e[l+f],e[l+f]=b,d++,f--;c+=g}return a}},function(a,f,h){function g(b,l){l=void 0===l?!1:l;for(var d="",e=0,c=b.length;e<c;){var a=k.lPadZeros(b[e].toString(2),8);d=l?d+a:a+d;e++}return d}var k=h(0),c=new Float32Array(1),b=new Int32Array(c.buffer);a.exports.getBinary=g;a.exports.decodeFloat16=function(b){b=parseInt(g(b,!0),2);var e=(b&31744)>>10,d=b&1023;return(e?Math.pow(2,e-15)*(1+d/1024):d/1024*.00006103515625)*
(b>>15?-1:1)};a.exports.decodeFloat64=function(b){if("0,0,0,0,0,0,0,0"==b.toString())return 0;b=g(b);for(var e="1"+b.substr(12,52),d=1,c=0,a=0;a<e.length;)c+=d*parseInt(e.charAt(a),10),d/=2,a++;return("1"==b.charAt(0)?-1:1)*c*Math.pow(2,parseInt(b.substr(1,11),2)-1023)};a.exports.toFloat64=function(b){if(0==b)return[0,0];var c=0;0>=b&&(c=2147483648,b=-b);var d=Math.floor(Math.log(b)/Math.log(2)),e=Math.floor(b/Math.pow(2,d)*Math.pow(2,52));b=e&4294967295;e/=Math.pow(2,32);return[c|d+1023<<20|e&1048575,
b]};a.exports.toHalf=function(e){c[0]=e;var a=b[0];e=a>>16&32768;var d=a>>12&2047;a=a>>23&255;return 103>a?e:(e|a-112<<10|d>>1)+(d&1)}},function(a,f){var h={8:256,16:65536,24:16777216,32:4294967296};a.exports.toBitDepth=function(a,k,c){if(k!=c){var b="8 16 24 32 32f 64".split(" ");if(-1==b.indexOf(k)||-1==b.indexOf(c))throw Error("Invalid bit depth.");b=a.length;for(var e=0;e<b;e++){var l=a[e];"8"==k&&(l-=128);if("32f"==c||"64"==c){var d=k,g=parseInt(h[d]/2,10);"32f"!=d&&"64"!=d&&(l=0<l?l/(g-1):l/
g)}else{d=l;g=k;l=c;var f=parseInt(h[g]/2,10),n=parseInt(h[l]/2,10);d="32f"==g||"64"==g?0<d?d*(n-1):d*n:0<d?parseInt(d/(f-1)*n-1,10):parseInt(d/f*n,10);"8"==l&&(d+=128);l=d}a[e]=l}}};a.exports.BitDepthMaxValues=h},function(a,f,h){a=h(8);window.WaveFile=a.WaveFile},function(a,f,h){h(3);var g=h(6),k=h(14);f=function(c,b,e){b=k.WaveFile.call(this,void 0===b?!1:b,void 0===e?!1:e)||this;c&&b.fromBuffer(c);return b};$jscomp.inherits(f,k.WaveFile);f.prototype.fromScratch=function(c,b,e,a,d){d=void 0===d?
{}:d;d.container||(d.container="RIFF");this.isFromScratch_=!0;var l=parseInt(e,10)/8;this.chunkSize=36+a.length*l;this.subChunk1Size=16;this.byteRate=c*l*b;this.blockAlign=c*l;this.chunkId=d.container;this.format="WAVE";this.subChunk1Id="fmt ";this.audioFormat=this.headerFormats_[e];this.numChannels=c;this.sampleRate=b;this.bitsPerSample=parseInt(e,10);this.subChunk2Id="data";this.subChunk2Size=a.length*l;this.samples_=a;this.bitDepth_=e};f.prototype.fromBuffer=function(a){this.isFromScratch_=!1;
this.readRIFFChunk_(a);this.readWAVEChunk_(a);this.readFmtChunk_(a);this.readFactChunk_(a);this.readBextChunk_(a);this.readDataChunk_(a)};f.prototype.toBuffer=function(){this.checkWriteInput_(this.numChannels,this.sampleRate,this.bitDepth_);this.samplesToBytes_();return new Uint8Array(this.createWaveFile_())};f.prototype.toRIFF=function(){this.chunkId="RIFF"};f.prototype.toRIFX=function(){this.chunkId="RIFX"};f.prototype.toBitDepth=function(a){g.toBitDepth(this.samples_,this.bitDepth_,a);this.fromScratch(this.numChannels,
this.sampleRate,a,this.samples_,{container:this.chunkId})};f.prototype.interleave=function(){var a=[],b,e,l=this.samples_[0].length;for(b=0;b<l;b++)for(e=0;e<this.samples_.length;e++)a.push(this.samples_[e][b]);this.samples_=a};f.prototype.deInterleave=function(){var a=[],b;for(b=0;b<this.numChannels;b++)a[b]=[];b=0;for(var e;b<this.samples_.length;){for(e=0;e<this.numChannels;e++)a[e].push(this.samples_[b+e]);b+=e}this.samples_=a};a.exports.WaveFile=f},function(a,f,h){function g(b,a,e){4==a?k(b,
e,c.paddingNibble):2==a?k(b,e,c.paddingCrumb):1==a?k(b,e,function(){}):k(b,e)}function k(b,a,e){e=void 0===e?c.padding:e;if(10!=a)for(var d=0,l=b.length;d<l;)b[d]=b[d].toString(a),e(b,a,d),d++}h(1);var c=h(0),b=h(4),e=h(10),l=h(2);a.exports.toBytes=function(a,c,k){k=void 0===k?{}:k;var d=10;"base"in k&&(d=k.base);var f=k.char?e.writeString:e["write"+c+"Bit"+(k.float?"Float":"")];for(var h=0,m=0,q=a.length,p=[];h<q;)m=f(p,a,h,m),h++;a=p;k.be&&b.endianness(a,l.BitDepthOffsets[c]);g(a,c,d);k.buffer&&
(a=new Uint8Array(a));return a}},function(a,f,h){function g(b,a,c,d){b[d++]=a[c]&255;b[d++]=a[c]>>>8&255;b[d++]=a[c]>>>16&255;b[d++]=a[c]>>>24&255;return d}var k=h(5),c=h(1);a.exports.write64Bit=function(b,a,c,d){a=k.toFloat64(a[c]);d=g(b,a,1,d);return g(b,a,0,d)};a.exports.write48Bit=function(b,a,c,d){b[d++]=a[c]&255;b[d++]=a[c]>>8&255;b[d++]=a[c]>>16&255;b[d++]=a[c]>>24&255;b[d++]=a[c]/4294967296&255;b[d++]=a[c]/1099511627776&255;return d};a.exports.write40Bit=function(b,a,c,d){b[d++]=a[c]&255;
b[d++]=a[c]>>8&255;b[d++]=a[c]>>16&255;b[d++]=a[c]>>24&255;b[d++]=a[c]/4294967296&255;return d};a.exports.write32BitFloat=function(a,e,l,d){e=c.unpack(e[l]);a[d++]=e&255;a[d++]=e>>>8&255;a[d++]=e>>>16&255;a[d++]=e>>>24&255;return d};a.exports.write32Bit=g;a.exports.write24Bit=function(a,c,l,d){a[d++]=c[l]&255;a[d++]=c[l]>>>8&255;a[d++]=c[l]>>>16&255;return d};a.exports.write16Bit=function(a,c,l,d){a[d++]=c[l]&255;a[d++]=c[l]>>>8&255;return d};a.exports.write16BitFloat=function(a,c,l,d){c=k.toHalf(c[l]);
a[d++]=c>>>8&255;a[d++]=c&255;return d};a.exports.write8Bit=function(a,c,l,d){a[d++]=c[l]&255;return d};a.exports.write4Bit=function(a,c,l,d){a[d++]=c[l]&15;return d};a.exports.write2Bit=function(a,c,l,d){a[d++]=0>c[l]?c[l]+4:c[l];return d};a.exports.write1Bit=function(a,c,l,d){a[d++]=c[l]?1:0;return d};a.exports.writeString=function(a,c,l,d){a[d++]=c.charCodeAt(l);return d}},function(a,f,h){function g(a,b,c,g){var d=[],l=0,f=0,h=e.BitDepthOffsets[b],m=a.length-(h-1);b=e.BitDepthMaxValues[b];for(c=
c?k:function(a,b){return a};l<m;)d[f]=c(g(a,l),b),l+=h,f++;return d}function k(a,b){a>parseInt(b/2,10)-1&&(a-=b);return a}var c=h(4),b=h(12),e=h(2);a.exports.fromBytes=function(a,d,e){e=void 0===e?{}:e;var l=10;"base"in e&&(l=e.base);e.be&&c.endianness(a,d/8);if(10!=l)for(var k=0,f=a.length;k<f;)a[k]=parseInt(a[k],l),k++;a=g(a,d,e.signed,e.char?b.readChar:b["read"+(2==d||4==d?8:d)+"Bit"+(e.float?"Float":"")]);e.char&&(a=a.join(""));return a}},function(a,f,h){function g(a,b,e){--e;for(var d="";0<=
e;)d+=c.bytePadding(a[e+b].toString(2),2),e--;return parseInt(d,2)}function k(a,b){return(a[3+b]<<24|a[2+b]<<16|a[1+b]<<8|a[b])>>>0}var c=h(0),b=h(5),e=h(1);a.exports.readChar=function(a,b){return String.fromCharCode(a[b])};a.exports.read1Bit=function(a,b){return parseInt(a[b],2)};a.exports.read8Bit=function(a,b){return a[b]};a.exports.read16Bit=function(a,b){return a[1+b]<<8|a[b]};a.exports.read16BitFloat=function(a,c){return b.decodeFloat16(a.slice(c,c+2))};a.exports.read24Bit=function(a,b){return a[2+
b]<<16|a[1+b]<<8|a[b]};a.exports.read32Bit=k;a.exports.read32BitFloat=function(a,b){return e.pack(k(a,b))};a.exports.read40Bit=function(a,b){return g(a,b,5)};a.exports.read48Bit=function(a,b){return g(a,b,6)};a.exports.read64Bit=function(a,c){return b.decodeFloat64(a.slice(c,c+8))}},function(a,f,h){var g=h(0);a.exports.packBooleans=function(a){var c=[],b=0,e=0;g.fixByteArraySize(a,8);for(var k=a.length-7;b<k;)c[e++]=parseInt(a[b].toString(2)+a[b+1].toString(2)+a[b+2].toString(2)+a[b+3].toString(2)+
a[b+4].toString(2)+a[b+5].toString(2)+a[b+6].toString(2)+a[b+7].toString(2),2),b+=8;return c};a.exports.unpackBooleans=function(a){for(var c=[],b=0,e=0,f=a.length,d;b<f;)d=g.lPadZeros(a[b].toString(2),8),c[e++]=parseInt(d[0],2),c[e++]=parseInt(d[1],2),c[e++]=parseInt(d[2],2),c[e++]=parseInt(d[3],2),c[e++]=parseInt(d[4],2),c[e++]=parseInt(d[5],2),c[e++]=parseInt(d[6],2),c[e++]=parseInt(d[7],2),b++;return c};a.exports.packCrumbs=function(a){var c=[],b=0,e=0;g.fixByteArraySize(a,4);for(var f=a.length-
3;b<f;)c[e++]=parseInt(g.lPadZeros(a[b].toString(2),2)+g.lPadZeros(a[b+1].toString(2),2)+g.lPadZeros(a[b+2].toString(2),2)+g.lPadZeros(a[b+3].toString(2),2),2),b+=4;return c};a.exports.unpackCrumbs=function(a){var c=[],b=0,e=0,f=a.length;for(console.log(f);b<f;){var d=g.lPadZeros(a[b].toString(2),8);c[e++]=parseInt(d[0]+d[1],2);c[e++]=parseInt(d[2]+d[3],2);c[e++]=parseInt(d[4]+d[5],2);c[e++]=parseInt(d[6]+d[7],2);b++}return c};a.exports.packNibbles=function(a){var c=[],b=0,e=0,f=a.length;for(f%2&&
a.push(0);b<f;)c[e++]=parseInt(a[b].toString(16)+a[b+1].toString(16),16),b+=2;return c};a.exports.unpackNibbles=function(a){for(var c=[],b=0,e=0,f=a.length;b<f;)c[e++]=parseInt(a[b].toString(16)[0],16),c[e++]=parseInt(a[b].toString(16)[1],16),b++;return c}},function(a,f,h){var g=h(3);h(6);var k=h(15);f=function(a,b,e){b=void 0===b?!1:b;e=void 0===e?!1:e;a=k.WaveFileHeader.call(this)||this;a.isFromScratch_=!1;a.enforceFact=b;a.enforceBext=e;a.WaveErrors={format:"Not a supported format.",wave:"Could not find the 'WAVE' chunk",
"fmt ":"Could not find the 'fmt ' chunk",data:"Could not find the 'data' chunk",fact:"Could not find the 'fact' chunk",bext:"Could not find the 'bext' chunk",bitDepth:"Invalid bit depth.",numChannels:"Invalid number of channels.",sampleRate:"Invalid sample rate."};a.samples_=[];a.bytes_=[];return a};$jscomp.inherits(f,k.WaveFileHeader);f.prototype.readRIFFChunk_=function(a){this.chunkId=g.fromBytes(a.slice(0,4),8,{"char":!0});if("RIFF"!=this.chunkId&&"RIFX"!=this.chunkId)throw Error(this.WaveErrors.format);
this.chunkSize=g.fromBytes(a.slice(4,8),32,{be:"RIFX"==this.chunkId})[0]};f.prototype.readWAVEChunk_=function(a){if(-1===g.findString(a,"WAVE"))throw Error(this.WaveErrors.wave);this.format="WAVE"};f.prototype.readFmtChunk_=function(a){var b=g.findString(a,"fmt ");if(-1===b)throw Error(this.WaveErrors["fmt "]);var c={be:"RIFX"==this.chunkId};this.subChunk1Id="fmt ";this.subChunk1Size=g.fromBytes(a.slice(b+4,b+8),32,c)[0];this.audioFormat=g.fromBytes(a.slice(b+8,b+10),16,c)[0];this.numChannels=g.fromBytes(a.slice(b+
10,b+12),16,c)[0];this.sampleRate=g.fromBytes(a.slice(b+12,b+16),32,c)[0];this.byteRate=g.fromBytes(a.slice(b+16,b+20),32,c)[0];this.blockAlign=g.fromBytes(a.slice(b+20,b+22),16,c)[0];this.bitsPerSample=g.fromBytes(a.slice(b+22,b+24),16,c)[0];this.bitDepth_=3==this.audioFormat&&32==this.bitsPerSample?"32f":this.bitsPerSample.toString()};f.prototype.readFactChunk_=function(a){a=g.findString(a,"fact");if(-1===a&&this.enforceFact)throw Error(this.WaveErrors.fact);-1<a&&(this.factChunkId="fact")};f.prototype.readBextChunk_=
function(a){a=g.findString(a,"bext");if(-1===a&&this.enforceBext)throw Error(this.WaveErrors.bext);-1<a&&(this.bextChunkId="bext")};f.prototype.readDataChunk_=function(a){var b=g.findString(a,"data");if(-1===b)throw Error(this.WaveErrors.data);this.subChunk2Id="data";this.subChunk2Size=g.fromBytes(a.slice(b+4,b+8),32,{be:"RIFX"==this.chunkId})[0];this.samplesFromBytes_(a,b)};f.prototype.samplesFromBytes_=function(a,b){var c={signed:8==this.bitsPerSample?!1:!0,be:"RIFX"==this.chunkId};32==this.bitsPerSample&&
3==this.audioFormat&&(c.float=!0);a=a.slice(b+8,b+8+this.subChunk2Size);this.samples_=4==this.bitsPerSample?g.fromBytes(a,8,c):g.fromBytes(a,this.bitsPerSample,c)};f.prototype.checkWriteInput_=function(){this.validateBitDepth_();this.validateNumChannels_();this.validateSampleRate_()};f.prototype.validateBitDepth_=function(){if(!this.headerFormats_[this.bitDepth_])throw Error(this.WaveErrors.bitDepth);return!0};f.prototype.validateNumChannels_=function(){var a=this.numChannels*this.bitsPerSample/8;
if(1>this.numChannels||65535<a)throw Error(this.WaveErrors.numChannels);return!0};f.prototype.validateSampleRate_=function(){var a=this.bitsPerSample/8*this.numChannels*this.sampleRate;if(1>this.sampleRate||4294967295<a)throw Error(this.WaveErrors.sampleRate);return!0};f.prototype.samplesToBytes_=function(){var a={be:"RIFX"==this.chunkId};32==this.bitsPerSample&&3==this.audioFormat&&(a.float=!0);this.bytes_=g.toBytes(this.samples_,4==this.bitsPerSample?8:this.bitsPerSample,a);this.bytes_.length%2&&
this.bytes_.push(0)};f.prototype.createWaveFile_=function(){var a=[];this.factChunkId&&(a=g.toBytes(this.factChunkId,8,{"char":!0}));var b={be:"RIFX"==this.chunkId};return g.toBytes(this.chunkId,8,{"char":!0}).concat(g.toBytes([this.chunkSize],32,b),g.toBytes(this.format,8,{"char":!0}),g.toBytes(this.subChunk1Id,8,{"char":!0}),g.toBytes([this.subChunk1Size],32,b),g.toBytes([this.audioFormat],16,b),g.toBytes([this.numChannels],16,b),g.toBytes([this.sampleRate],32,b),g.toBytes([this.byteRate],32,b),
g.toBytes([this.blockAlign],16,b),g.toBytes([this.bitsPerSample],16,b),a,g.toBytes(this.subChunk2Id,8,{"char":!0}),g.toBytes([this.subChunk2Size],32,b),this.bytes_)};a.exports.WaveFile=f},function(a,f){a.exports.WaveFileHeader=function(){this.chunkId="";this.chunkSize=0;this.format=this.subChunk1Id="";this.cbSize=this.bitsPerSample=this.blockAlign=this.byteRate=this.sampleRate=this.numChannels=this.audioFormat=this.subChunk1Size=0;this.factChunkId="";this.factChunkSize=4;this.dwSampleLength=0;this.subChunk2Id=
"";this.subChunk2Size=0;this.bextChunkId="";this.headerFormats_={4:17,8:1,16:1,24:1,32:1,"32f":3,64:3}}}]);
